\documentclass[11pt,a4paper,notitlepage,fleqn]{article}

\input{preamble.tex}

\title{Αναλογικές Τηλεπικοινωνίες
	\\
	{ 
		\normalsize Σημειώσεις από τις παραδόσεις
	}}
\date{Οκτώβριος-Ιανουάριος 2017
	\\
	{ 
		\small Τελευταία ενημέρωση: \today
	}
}
\author{
	Για τον κώδικα σε \LaTeX, ενημερώσεις και προτάσεις:
	\\
	\url{https://github.com/kongr45gpen/ece-notes}}

\setallmainfonts(Digits,Latin,Greek){Asana Math}
\setmainfont{Noto Serif}
\setsansfont{Ubuntu}
%\usepackage{unicode-math}
\usepackage{polyglossia}
\newfontfamily\greekfont[Script=Greek,Scale=0.95]{Noto Serif}
\setmathfont{XITS Math}

\hypersetup{pdftitle = {Αναλογικές Τηλεπικοινωνίες}}


\begin{document}
\maketitle

\hrule
\vspace{50pt}
	
Αναλογικές Τηλεπικοινωνίες

\begin{attnbox}{Εγγραφή στη λίστα}
	Μήνυμα στο \href{mailto:dimakis@auth.gr}{\texttt{dimakis@auth.gr}} με θέμα
	\textit{\textbf{Αναλογικές Τηλεπικοινωνίες}}.
	
	\tcblower
	
	Στη λίστα θα στέλνονται ασκήσεις χρήσιμες για τις εξετάσεις και λοιπές ανακοινώσεις.
\end{attnbox}

\begin{attnbox}{Μάθημα}
	Το μάθημα της Παρασκευής καταργείται.
	Θα γίνονται μαθήματα σε κοινό τμήμα την Τρίτη και την Τετάρτη
	από τον κ. Δημάκη.
\end{attnbox}

Εξετάσεις: Όλα ανοιχτά.

Το μάθημα θα γίνει με βάση το βιβλίο του Haykin.

Ιστοσελίδα Ασκήσεων:
\url{http://genesis.ee.auth.gr/dimakis/greek/courses/telesysI}

\section{Εισαγωγή}
Επικοινωνία είναι η μεταφορά μηνυμάτων, που μπορεί να έχουν τη μορφή απλών συμβόλων / φθόγγων
ή πιο περίπλοκων μηνυμάτων.

Για τον μηχανικό, επικοινωνία είναι η μετάδοση ή μεταφορά πληροφορίας από ένα σημείο \( A \) σε ένα σημείο \( B \) του χώρου.

\begin{center}
	\begin{tikzpicture}
	\draw[thin,gray,dashed] (0,0) -- (2,0);
	\filldraw (0,0) circle (2pt) node[left] {$A$};
	\filldraw (2,0) circle (2pt) node[right] {$B$};
	\end{tikzpicture}
\end{center}

Την πληροφορία μπορούμε να την ορίσουμε ως ένα σύνολο ταξινομημένων συμβόλων, που μαζί ίσως
σχηματίζουν μια λέξη, μια πρόταση, ή ένα νόημα. Ένας καλύτερος ορισμός έχει δοθεί από τον
Shannon στη Θεωρία Πληροφοριών.

Μία ακόμα παράμετρος είναι ο χρόνος μεταφοράς της πληροφορίας, αν και συνήθως δεν μας
ενδιαφέρει στις αναλογικές τηλεπικοινωνίες (δεδομένης της ταχύτητας του φωτός), εκτός
αν προσπαθούμε να επικοινωνήσουμε με κάτι εκτός του πλανήτη.

Τα σήματα αυτά μπορούν να μεταφέρουν αριθμούς, κείμενο, εικόνα, ήχο, βίντεο, αρχεία κ.ά, και
βρίσκονται σε σχετικά χαμηλές συχνότητες (\textbf{baseband}). Για παράδειγμα, το εύρος της ανθρώπινης φωνής που
απαιτείται για να είναι καταληπτή είναι \( 300 \ \mathrm{Hz} \)-\( 3300\ \mathrm{Hz} \), ενώ
τα τηλεοπτικά σήματα κωδικοποιούνται σε συχνότητες έως \( 6 \ \mathrm{MHz} \). Τέτοιες
συχνότητες όμως είναι δύσκολο να μεταδοθούν (αν π.χ. σκεφτούμε ότι οι συχνότητες αρκετών
ηλεκτρομαγνητικών κυμάτων ή του ορατού φωτός είναι της τάξης των \( \mathrm{GHz} \) και
\( \mathrm{THz} \)). Επομένως, για να επιτύχει η επικοινωνία απαιτείται η αύξηση της
συχνότητας του σήματος, μέσω μιας διαδικασίας που λέγεται \textbf{διαμόρφωση}.

\begin{tikzpicture}[scale=1]
\def\h{0.6}
\filldraw (-0.5,0) circle(1.5pt) node[left] {$A$};
\draw (0,-\h/2) rectangle ++(1.5,\h) node[midway] {Πηγή};
\draw (1.5,0) -- (1.95,0);
\node[cloud, cloud puffs=15.7, cloud ignores aspect,
rotate=90,minimum width=3cm, minimum height=1.2cm, align=center, draw]
(cloud) at (2.63cm, 0cm) {Διαμόρφωση};
\draw (3.3,0) -- (3.7,0);
\draw (3.7,-\h/2) rectangle ++(1.5,\h) node[midway] {Πομπός};

\draw[->] (5.2,0) -- ++ (0.2,0) -- ++(0,-1) -- ++(0.3,0);
\draw 
(5.7,-1-2*\h/2) rectangle ++(3,2*\h) node[midway,align=center,rectangle] {Κανάλι\\Μέσο διάδοσης};
\draw (8.7,-1) -- ++(0.3,0) -- ++(0,1) -- ++(0.2,0);
\draw (9.2,-\h/2) rectangle ++(1.5,\h) node[midway] {Δέκτης};
\draw (10.7,0) -- ++(0.35,0);
\node[cloud, cloud puffs=15.7, cloud ignores aspect,
rotate=90,minimum width=3cm, minimum height=1.6cm, align=center, draw]
(cloud) at (11.85cm, 0cm) {Αποδιαμόρφωση};
\draw (12.6,0) -- (13,0);
\draw (13,-\h/2) rectangle ++(1.8,\h) node[midway,scale=.9] {Αποδέκτης};
\filldraw (14.8+0.5,0) circle(1.5pt) node[right] {$B$};
\end{tikzpicture}

Η επιλογή της κατάλληλης συχνότητας του σήματος που θα στείλουμε από την κεραία, εξαρτάται
από τα χαρακτηριστικά του ηλεκτρομαγνητικού κύματος. Για παράδειγμα, πιο χαμηλές συχνότητες
(π.χ. AM) μπορούν να περάσουν μέσα από βουνά και εμπόδια, φτάνοντας σε μεγάλες αποστάσεις
στον πλανήτη, και ακολουθώντας την καμπύλη της γης. Τα βραχέα μπορούν να χτυπήσουν στην
ιονόσφαιρα και να ανακλαστούν για ακόμα μεγαλύτερη κάλυψη. Αντιθέτως, οι υψηλές συχνότητες
(π.χ. FM) επιτρέπουν υψηλότερη ποιότητα μετάδοσης.

\begin{wrapfigure}{r}{0.3\textwidth}\centering
	\begin{tikzpicture}[scale=.5,every node/.style={scale=.7}]
	\def\l{1}
	\def\h{3.5}
	\def\N{7}
	
	\begin{scope}[every node/.style={midway,above,scale=.4}]
	\draw[->] (0,1) -- (0,0) node[midway,right] {user};
	\draw (-\l,0) rectangle (\l,-\h);
	\draw(-\l,-1*\h/7) -- ++(2*\l,0) node {Application};
	\draw(-\l,-2*\h/7) -- ++(2*\l,0) node {Presentation};
	\draw(-\l,-3*\h/7) -- ++(2*\l,0) node {Session};
	\draw(-\l,-4*\h/7) -- ++(2*\l,0) node {Transport};
	\draw(-\l,-5*\h/7) -- ++(2*\l,0) node {Network};
	\draw(-\l,-6*\h/7) -- ++(2*\l,0) node {Data Link};
	\draw(-\l,-7*\h/7) -- ++(2*\l,0) node[scale=1.3,yshift=-1mm] {Physical};
	\end{scope}
	
	\begin{scope}[every node/.style={midway,above,scale=.4,baseline},xshift=5cm]
	\draw[<-] (0,1) -- (0,0) node[midway,right] {user};
	\draw (-\l,0) rectangle (\l,-\h);
	\draw(-\l,-1*\h/7) -- ++(2*\l,0) node {Application};
	\draw(-\l,-2*\h/7) -- ++(2*\l,0) node {Presentation};
	\draw(-\l,-3*\h/7) -- ++(2*\l,0) node {Session};
	\draw(-\l,-4*\h/7) -- ++(2*\l,0) node {Transport};
	\draw(-\l,-5*\h/7) -- ++(2*\l,0) node {Network};
	\draw(-\l,-6*\h/7) -- ++(2*\l,0) node {Data Link};
	\draw(-\l,-7*\h/7) -- ++(2*\l,0) node[scale=1.3,yshift=-1mm] {Physical};
	\end{scope}
	
	\draw (0,-\h) -- ++(0,-1) -- ++(1.5,0);
	\draw (1.5,-\h-1+0.4) rectangle ++(2,-0.8) node[midway] {Κανάλι};
	\draw (3.5,-\h-1) -- ++(1.5,0) -- ++(0,1);
	
	\draw[<->,thick,gray] (1.5,-1.7) to[bend left] node[midway,above] {Peer} ++(2,0);
	
	\draw (current bounding box.north) node[rectangle,align=center]
	{OSI\\7 επιπέδων};
	\end{tikzpicture}
\end{wrapfigure}

Για την κωδικοποίηση και αποκωδικοποίηση των δεδομένων, πρέπει ο πομπός και ο δέκτης να
συμφωνήσουν σε ένα κοινό πρότυπο, για παράδειγμα στο TCP/IP ή το OSI 7 επιπέδων.

Σε αυτό το μάθημα μας ενδιαφέρει το φυσικό επίπεδο μόνο.

Οι ψηφιακές επικοινωνίες αναφέρονται σε ψηφιακά δεδομένα, αλλά πρακτικά η μετάδοση
του σήματος μέσω των καναλιών (π.χ ηλεκτρομαγνητικά κύματα) είναι αναλογική, αφού δεν γίνεται
να έχουμε άμεση μετάβαση της κατάστασης από 0 ως 1:

\begin{tikzpicture}[scale=1]
\draw (0,-2) -- (0,2);
\draw (0,0) -- (6,0);

\draw[very thick,black!70!blue] plot[const plot]
coordinates {(0,1) (1,-1) (3,1) (4,-1) (5.5,1) (6,1)};

\draw[very thick,black!20!cyan!80!blue] plot[const plot,smooth,tension=0.8]
coordinates {(0,0.8) (0.8,0.7) (1.5,-1.4) (2.7,-0.8) (3.5,1) (4.9,-1.2) (5.5,1) (6,1.2)};

\filldraw[fill=black!70!blue] (7,-0.3) rectangle ++(0.2,0.2) node[midway,right,xshift=1mm] {ψηφιακό σήμα};

\filldraw[fill=black!20!cyan!80!blue] (7,-0.8) rectangle ++(0.2,0.2) node[midway,right,xshift=1mm] {πραγματικό σήμα};
\end{tikzpicture}

Πρακτικά οι αναλογικές τηλεπικοινωνίες χρησιμοποιούνται πλέον μόνο στους ραδιοφωνικούς
σταθμούς FM (που αρχίζουν και αυτοί να καταργούνται), αλλά συνεχίζουμε να τις μελετάμε για
λόγους ιστορικούς, διδακτικούς, και επειδή το σήμα όπως αναφέρθηκε παραπάνω είναι εν γένει
αναλογικό. Στο νέο πρόγραμμα σπουδών δεν υπάρχει ακριβώς αυτό το μάθημα.

\subsection{Βασικές έννοιες}
\paragraph{Σήμα βασικής συχνότητας (baseband)}
Τα σήματα βασικής συχνότητας (\textbf{baseband}) προέρχονται από το αρχικό σήμα σε
"χαμηλές" συχνότητες όπως αναφέρθηκε παραπάνω (συνήθως από 0 μέχρι π.χ. 20 \( \mathrm{kHz} \)
ή 6 \( \mathrm{MHz} \)):

\begin{tikzpicture}[scale=1]
\def\s{ (0,0) (0.5,1) (0.7,1.2+0.1*rand) (1,1.5) (1.2,1.2+0.1*rand) (1.4,1+0.1*rand)
	(1.6, 0.7+0.2*rand) (1.8,0.4+0.15*rand) (2,0)}

\pgfmathsetseed{15}
\draw[very thick, orange] plot [smooth] coordinates \s;
\pgfmathsetseed{15}
\draw (2,0) node[below] {$w$};

\draw (0,0) node[below left] {$0$};
\draw (-3,0) -- (3,0) node[below right] {$\mathrm{Hz}$};
\draw (0,-0.2) -- (0,2);
\end{tikzpicture}

Ή, επειδή χρησιμοποιούμε \textit{δίπλευρα} φάσματα:

\begin{tikzpicture}[scale=1]
\def\s{ (0,0) (0.5,1) (0.7,1.2+0.1*rand) (1,1.5) (1.2,1.2+0.1*rand) (1.4,1+0.1*rand)
	(1.6, 0.7+0.2*rand) (1.8,0.4+0.15*rand) (2,0)}

\pgfmathsetseed{15}
\draw[very thick, orange] plot [smooth] coordinates \s;
\pgfmathsetseed{15}
\draw[very thick, orange!90!brown, xscale=-1] plot [smooth] coordinates \s;
\draw (2,0) node[below] {$w$};
\draw (-2,0) node[below] {$-w$};

\draw (0,0) node[below left] {$0$};
\draw (-3,0) -- (3,0) node[below right] {$\mathrm{Hz}$};
\draw (0,-0.2) -- (0,2);
\end{tikzpicture}

Η μέγιστη θετική συχνότητα \( w \) ορίζει το \textbf{εύρος ζώνης (bandwidth)} του σήματος.

Η διαδικασία που θα χρησιμοποιήσουμε για να αυξήσουμε τη συχνότητα του σήματος ονομάζεται
\textbf{διαμόρφωση (modulation)}.

Συνήθως έχουμε μια \textbf{φέρουσα συχνότητα}:
\[
c(t) = A_c\cos(2\pi f_c t)
\]
και πρέπει να βρούμε έναν τρόπο να προσθέσουμε σε αυτήν τις πληροφορίες του αρχικού σήματος.
Στην παραπάνω εξίσωση έχουμε τρεις παραμέτρους που μπορούμε να επηρεάσουμε: το πλάτος,
τη συχνότητα και τη φάση:
\[
c(t) =
\underset{\substack{\downarrow\\\mathclap{A_c(t)}}}{A_c}
\cos(2\pi
\underset{\substack{\downarrow\\\mathclap{f_c(t)}}}{f_c}
t
+
\underset{\substack{\downarrow\\\mathclap{\phi(t)}}}{\phi}
)
\]

Έτσι έχουμε τρία είδη διαμόρφωσης:
\begin{description}
	\item[AM] Διαμόρφωση Πλάτους (Amplitude Modulation)
	\item[FM] Διαμόρφωση Συχνότητας (Frequency Modulation)
	\item[PM] Διαμόρφωση Φάσης (Phase Modulation)
\end{description}

\section{Διαμόρφωση Πλάτους}

\subsection{AM}
Έστω το \emph{φέρον}:
\[
c(t) = A_c\cos(2\pi f_c t)
\]
και θέλουμε να μεταφέρουμε ένα σήμα:
\[
m(t) \qquad \text{στη βασική ζώνη}
\]

Θεωρούμε, για λόγους που θα δούμε παρακάτω, ότι το φέρον έχει συχνότητα πολύ μεγαλύτερη
από το εύρος ζώνης της πληροφορίας:
\[
f_c \gg w
\]

Το σήμα που εκπέμπουμε κατά AM είναι το εξής:
\[
\mathlarger{
	\mathlarger{
		\mathlarger{
			s(t) = A_c\left[ 1 + k_a \cdot m(t) \right]\cos(2\pi f_c t)
		}
	}
}
\]
το οποίο μπορεί να εκφράζεται σε Volt ή Ampere και ίσως εκπέμπεται από κάποια κεραία.

Γραφικά: \\* {\centering
\begin{tikzpicture}[scale=1.2,xscale=1.3]
\def\f{1.3+0.30362*\x-6.94276*\x^2+5.23511*\x^3-0.0466465*\x^4-0.696833*\x^5+0.128634*\x^6}
%coordinates {(0,1.5) (0.7,0) (1.2,-0.5) (1.5,0) (2,1.5)  (3,1.5) (3.2,1.5)}
\draw (0,-1.5) -- (0,2);
\draw (0,0) -- (3,0);

\draw[very thick,black!70!blue,variable=\x,samples=\gsamples,domain=0:3]
plot ({\x},{\f}) (0,1.3) node[left] {$m(t)$};

\begin{scope}[yshift=-4cm]
\draw (0,-2) -- (0,2);
\draw (0,0) -- (3,0);

\draw[thick,blue!70!black,variable=\x,samples=\gsamples,domain=0:3,smooth] plot ({\x},{(1.5*sin(\x r*40))}) (0,1.5) node[above right] {$c(t)$};
\draw (0,-1.5) node[left] {$-A_c$};
\draw (0,1.5) node[left] {$A_c$};
\end{scope}

\begin{scope}[xshift=5cm]
\draw (0,-0.5) -- (0,3);
\draw (0,0) -- (3,0);

\draw[very thick,black!70!blue,variable=\x,samples={\gsamples/2},domain=0:3,opacity=.05]
plot ({\x},{\f}) (0,1.3);
\draw[very thick,black!70!blue,variable=\x,samples=\gsamples,domain=0:3,smooth]
plot ({\x},{\f+1}) (0,1.3+1) node[left] {$\left[1+k_am(t)\right]$};
\end{scope}

\begin{scope}[xshift=5cm,yshift=-4cm]
\draw[thin,dashed,cyan!70!blue,variable=\x,samples=\gsamples,domain=0:3]
plot ({\x},{\f+1}) (0,1.3+1);
\draw[very thick,green!70!blue,variable=\x,samples=\gsamples,domain=0:3]
plot ({\x},{(\f+1)*sin(\x r*40)}) (1.3+1,0);

\draw[->,cyan!70!blue] (2.65,3) to[bend left] ++(1,1) node[above right] {Περιβάλλουσα};

\draw (0,-3) -- (0,3);
\draw (0,0) -- (3,0);
\end{scope}
\end{tikzpicture}
}

Η περιβάλλουσα του διαμορφωμένου σήματος περιέχει την πληροφορία που θέλουμε.

Η σταθερά \( k_a \) ονομάζεται \textbf{ευαισθησία πλάτους} του διαμορφωτή, και θέλουμε
να είναι τέτοια ώστε \( \left[1 + k_a m(t)\right] > 0 \), διότι σε διαφορετική περίπτωση:

\begin{tikzpicture}[scale=1,xscale=1.3]
\def\f{1.3+0.30362*\x-6.94276*\x^2+5.23511*\x^3-0.0466465*\x^4-0.696833*\x^5+0.128634*\x^6}
%coordinates {(0,1.5) (0.7,0) (1.2,-0.5) (1.5,0) (2,1.5)  (3,1.5) (3.2,1.5)}
\draw (0,-2) -- (0,2);
\draw (0,0) -- (3,0);

\draw[very thick,black!70!blue,variable=\x,samples=\gsamples,domain=0:3]
plot ({\x},{\f}) (0,1.3);

\begin{scope}[xshift=5cm]
\draw[very thick,green!70!blue,variable=\x,samples=\gsamples,domain=0:3]
plot ({\x},{(\f)*sin(\x r*40)}) (1.3+1,0);
\draw[very thick,black!70!blue,variable=\x,samples=\gsamples,domain=0:3]
plot ({\x},{abs(\f)}) (0,1.3);

\draw (0,-2) -- (0,2);
\draw (0,0) -- (3,0);
\end{scope}
\end{tikzpicture}

Επειδή ο αποδιαμορφωτής βλέπει μόνο τις θετικές κορυφές του σήματος, εδώ δεν έχει μεταφέρει
σωστά την πληροφορία στα σημεία όπου \(  \left[1 + k_a m(t)\right] < 0  \), αλλά την έχει
μεταφέρει ανεστραμμένη. Αυτό ονομάζεται \textbf{υπερδιαμόρφωση}.

Επομένως, θέλουμε:
\begin{align*}
	1+ k_a m(t) &\geq 0 \implies \\
	\Aboxed{\left\lvert k_a m(t) \right\rvert &\leq 1} \implies \\
	-1 \leq k_a m(t) &\leq 1
\end{align*}

Παρατηρούμε ότι για να μην έχουμε υπερδιαμόρφωση, το σήμα μας δεν μπορεί να αποκτά πολύ
μεγάλο πλάτος.

\begin{defn}{Ποσοστό διαμόρφωσης}{}
	Ως \textbf{ποσοστό διαμόρφωσης} ορίζουμε:
	\[
	\left\lvert
	\max k_a m(t)
	\right\rvert \cdot 100
	\]
\end{defn}

\paragraph{}
Ξαναγράφουμε το σήμα και παίρνουμε το μετασχηματισμό Fourier:
\begin{align*}
	s(t) &= A_c \cos 2\pi f_c t + Ak_a m(t) \cos 2\pi f_c (t) \\
	S(f) &=
	\frac{A_c}{2}\left[ δ(f-f_c)+δ(f+f_c) \right]
	+ \frac{k_aA_c}{2}\left[ M(f-f_c) + M(f+f_c) \right]
\end{align*}

\begin{tikzpicture}[scale=1]
\draw[draw=orange!50!brown,very thick]
(-1.2,0) node[below] {$-w$}
-- (0,1.8) node[right] {$M(0)$}
-- (1.2,0) node[below] {$w$}
;

\draw (-2,0) -- (2,0);
\draw (0,-0.5) -- (0,3) node[right] {$M(f)$};

\begin{scope}[yshift=-4.5cm]
\draw[xshift=-2cm,draw=black!50!orange,dashed,very thick,every node/.style={scale=.9}]
(-1.2,0) node[below] {$-f_c-w$}
-- (0,1.8)
-- (1.2,0) node[below] {$-f_c+w$}
(0,0) node[below] {$-f_c$}
;
\draw[xshift=2cm,draw=black!50!orange,dashed,very thick,every node/.style={scale=.9}]
(-1.2,0) node[below] {$f_c-w$}
-- (0,1.8)
-- (1.2,0) node[below] {$f_c+w$}
(0,0) node[below] {$f_c$}
;
\draw[ultra thick,->] (-2,0) -- ++(0,2.5)
node[above] {$\sfrac{A_c}{2}$};
\draw[ultra thick,->] (2,0) -- ++(0,2.5);

\draw (-4,0) -- (4,0);
\draw[->] (0,-0.5) -- (0,3) node[right] {$S(f)$};

\draw[dashed] (-2.1,2.5) --++(4.2,0);
\draw[dashed] (-2.1,1.8) --++(4.2,0);
\draw (0,1.8) node[above right,scale=.7] {$\sfrac{1}{2}k_aA_cM(0)$};

\end{scope}
\end{tikzpicture}

Βλέπουμε ότι το φάσμα του σήματος μετακινήθηκε στη συχνότητα.

Παρατηρούμε επίσης ότι το φάσμα είναι δίπλευρο, και θυμόμαστε από το αναλογικό σήμα ότι
η αρνητική συχνότητα δεν έχει φυσική σημασία, αλλά εκφράζει τον αρνητικό εκθέτη στην
έκφραση του συνημιτόνου \( 
\mathrm{Re}\left[
\frac{e^{jωt}+e^{-jωt}}{2}
\right]
 \).
 
Αν έχουμε \textbf{μικρή συχνότητα} \( f_c \), τότε το φάσμα του σήματος περνάει το 0:

\begin{tikzpicture}[scale=1]
\draw[dashed] (0.7,0) -- ++(0,1.8);
\draw[xshift=-0.7cm,draw=orange!50!brown,,very thick,every node/.style={scale=.9}]
(-1.2,0)
-- (0,1.8)
-- (1.2,0)
(0,0)
;
\draw[xshift=0.7cm,draw=blue!50!brown,very thick,every node/.style={scale=.9}]
(-1.2,0) node[below] {$f_c-w$}
-- (0,1.8)
-- (1.2,0) node[below] {$f_c+w$}
(0,0) node[below] {$f_c$}
;

\draw[draw=gray!70!black,thin] (-3,0) -- (3,0);
\draw[->,draw=gray!70!black,thin] (0,-0.5) -- (0,3) node[right] {$S(f)$};

\draw[very thick,black!70!gray,->] (0,-0.75) -- ++(0,-0.5);

\begin{scope}[yshift=-4.5cm]
\draw[->,draw=gray!70!black,thin] (0,-0.5) -- (0,3) node[right] {$S(f)$};

\draw[very thick,orange!50!brown] (-1.9,0) -- (-0.7,1.8) -- (-0.5,1.5) -- (-0.49,1.5);
\draw[very thick,blue!50!brown]
(-0.5,1.5) -- (0.5,1.5);
\draw[very thick,path fading=east,orange!50!brown]
(-0.5,1.5) -- (0.5,1.5);
\draw[very thick,blue!50!brown] (0.49,1.5) -- (0.5,1.5) -- (0.7,1.8) -- (1.9,0);

\draw[draw=gray!70!black,thin] (-3,0) -- (3,0);

\end{scope}
\end{tikzpicture}

και το αποτέλεσμα είναι παραμορφωμένο και μακριά από το επιθυμητό.

Το εύρος φάσματος του σήματος είναι \( 2w \) (από \( f_c-w \) μέχρι \( f_c+w \)), το οποίο
είναι περισσότερο απ' όσο χρειάζεται (αφού το αριστερό του μέρος είναι ίδιο με το δεξί),
ενώ το σήμα είναι και ενεργειοβόρο, αφού τα \( \sfrac{2}{3}  \) της ενέργειας καταναλώνονται
στον όρο \( δ \) και όχι στην πληροφορία.

\begin{tikzpicture}[scale=0.8]
\draw[xshift=-3cm,fill=gray,fill opacity=0.04]
(-1.6,0) -- ++(0,3) -- ++(1.6*2,0) -- ++(0,-3);
\draw[xshift=3cm,fill=gray,fill opacity=0.04]
(-1.6,0) -- ++(0,3) -- ++(1.6*2,0) -- ++(0,-3);

\draw[xshift=-3cm,draw=black!50!orange,very thick,every node/.style={scale=.8}]
(-1.2,0) node[below] {$-f_c-w$}
-- (0,1.8)
-- (1.2,0) node[below] {$-f_c+w$}
(0,0) node[below] {$-f_c$}
;
\draw[xshift=3cm,draw=black!50!orange,very thick,every node/.style={scale=.8,opacity=1},
fill=lime!60!green,fill opacity=.5]
(-1.2,0) node[below] {$f_c-w$}
-- (0,1.8)
-- (1.2,0) node[below] {$f_c+w$}
(0,0) node[below] {$f_c$}
;
\draw[ultra thick,->] (-3,0) -- ++(0,2.5);
\draw[ultra thick,->] (3,0) -- ++(0,2.5);

\draw (-5.5,0) -- (5.5,0);
\draw[->] (0,-0.5) -- (0,4) node[right] {$S(f)$};

\draw[xshift=-3cm]
(-1.6,0) -- ++(0,3) -- ++(1.6*2,0) -- ++(0,-3);
\end{tikzpicture}

\subsubsection{Για ημιτονοειδή είσοδο}
Έστω ένα αρχικά ημιτονοειδές σήμα:
\[
m(t) = A_m\cos(2\pi f_mt)
\]

Τότε το διαμορφωμένο σήμα AM γίνεται:
\begin{align*}
s(t) &= A_c \left[
1 + \overbrace{μ}^{\mathclap{μ = k_aA_m}}
\cdot \cos(2\pi \cdot f_m t)
\right]\cos(2\pi f_c t)
\hspace{200pt}
\boxed{
μ \leq 1
}
\\
&= A_c\cos(2\pi f_c t) + A_c μ\cos(2\pi f_c t)\cos(2\pi f_mt)
\\ &=
A_c\cos2πf_ct + \frac{1}{2}μA_c \cos\left[2π(f_c+f_m)t\right]
+\frac{1}{2} μA_c\cos\left[
2π(f_c-f_m)t
\right]
\\
\updownarrow &\quad \text{Μ. F}
\\
S(f) &= \mathsmaller{\mathsmaller{\frac{1}{2} A_c \left[
δ(f-f_c)+δ(f+f_c) \right]
+ \frac{1}{4}μA_c \left[
δ(f-f_c-f_m)+δ(f-f_c+f_m)
\right]
+ \frac{1}{4} μA_c\left[
δ(f-f_c+f_m)+δ(f+f_c-f_m)
\right]}}
\end{align*}

Γραφικά:\nopagebreak

\begin{center}
	\begin{tikzpicture}[scale=1]
	\draw (0,-1.8) -- (0,2);
	\draw (0,0) -- (6,0);
	
	\draw[very thick,black!70!blue,variable=\x,samples=\gsamples,domain=0:6]
	plot ({\x},{1.4*cos(1.5*\x r)}) (1.1,1) node[] {$m(t)$};
	
	\draw (0,1.4) node[left] {$A_m$};
	\draw (0,-1.4) node[left] {$-A_m$};
	
	\draw[dashed] (2/1.5*pi,0) node[below] {$T_m=\frac{1}{f_m}$} -- ++(0,1.4);
	
	\begin{scope}[yshift=-5cm]
	\draw (0,-1.8) -- (0,2);
	\draw (0,0) -- (6,0);
	
	\draw[very thick,blue!70!cyan,variable=\x,samples=\gsamples,domain=0:6,smooth]
	plot ({\x},{1.2*sin(26*\x r)}) (1,1.2) node[above] {$c(t)$};
	
	\draw (0,1.2) node[left] {$A_c$};
	\draw (0,-1.2) node[left] {$-A_c$};
	
	\draw[dashed] (0,1.2) -- ++(6,0);
	\end{scope}
	
	\begin{scope}[yshift=-10cm]
	\draw (0,-2.5) -- (0,2.5);
	\draw (0,0) -- (6,0);
	
	\draw[dashed,variable=\x,samples=\gsamples,domain=0:6]
	plot ({\x},{1+0.7*cos(1.5*\x r)});
	\draw[dashed,variable=\x,samples=\gsamples,domain=0:6]
	plot ({\x},{-1-0.7*cos(1.5*\x r)});
	
	\draw[very thick,green!70!blue,variable=\x,samples=\gsamples,domain=0:6,smooth]
	plot ({\x},{(1+0.7*cos(1.5*\x r))*sin(26*\x r)}) (1.2,1.2) node[above] {$s(t)$};


	\end{scope}
	
	\begin{scope}[xshift=10cm]
	\draw (-3,0) -- (3,0);
	\draw[->] (0,-1) -- (0,2) node[right] {$M(f)$};
	
	\draw[black!70!blue,ultra thick,->] (-0.7,0) node[below] {$-f_m$}-- ++(0,1.5);
	\draw[black!70!blue,ultra thick,->] (0.7,0) node[below] {$f_m$}-- ++(0,1.5);
	
	\begin{scope}[yshift=-5cm]
	\draw (-3,0) -- (3,0);
	\draw[->] (0,-1) -- (0,2) node[right] {$C(f)$};
	
	\draw[blue!70!cyan,ultra thick,->] (-2.5,0) node[below] {$-f_c$}-- ++(0,1.5);
	\draw[blue!70!cyan,ultra thick,->] (2.5,0) node[below] {$f_c$}-- ++(0,1.5);
	\end{scope}
	
	\begin{scope}[yshift=-10cm]
	\draw (-3,0) -- (4,0);
	\draw[->] (0,-1) -- (0,2) node[right] {$S(f)$};
	
	\draw[blue!70!cyan,ultra thick,->] (-2.5,0) node[below] {$-f_c$}-- ++(0,1.5);
	\draw[black!70!blue,very thick,->] (-2.8,0) -- ++(0,0.7);
	\draw[black!70!blue,very thick,->] (-2.2,0) -- ++(0,0.7);
	
	\draw[blue!70!cyan,ultra thick,->] (2.5,0) node[below,scale=1] {$f_c$}-- ++(0,1.5);
	\draw[black!70!blue,very thick,->] (2.2,0) node[below left,scale=.9] {$f_c-f_m$}-- ++(0,0.7);
	\draw[black!70!blue,very thick,->] (2.8,0) node[below right,scale=.9] {$f_c+f_m$}-- ++(0,0.7);
	\end{scope}
	\end{scope}
	\end{tikzpicture}
\end{center}

\[
\underset{\substack{\downarrow\\\mathclap{\text{Bandwidth}}}}{\mathrm{B_T}}
=2f_m = 2w
\]

Επίσης προκύπτει ότι:
\begin{align*}
\frac{A_{\max}}{A_{\min}} &= \frac{A_c(1+μ)}{A_c(1-μ)} \implies \\
μ &= \frac{A_{\max} -A_{\min} }{A_{\max} + A_{\min}}
\end{align*}

\subsubsection{Ισχύς}
Αν μας ζητούνταν η ισχύς του σήματος, θα απαντούσαμε \( \frac{1}{2}A_c^2R \), αν θεωρήσουμε
ότι το σήμα είναι μια ένταση ρεύματος που διαρρέει κάποια αντίσταση \( R \). Στα σήματα
όμως θεωρούμε ότι η αντίσταση αυτή είναι 1, άρα παίρνουμε ίδιο αποτέλεσμα, είτε θεωρούμε ότι
το σήμα αναπαριστά ρεύμα, είτε τάση.

Επομένως η ισχύς π.χ. του φέροντος είναι:
\[
\boxed{
\frac{1}{2}A_c^2
	}
\]

Το πλευρικό σήμα για ημιτονοειδή είσοδο έχει ενέργεια:
\[
2\times \frac{1}{8}μ^2A_c^2
\]

και ο λόγος του με τη συνολική ενέργεια είναι:
\[
\frac{2\cdot \frac{1}{8} μ^2A_c^2}{\frac{1}{2}A_c^2+2\cdot\frac{1}{8}μ^2A_c^2}
= \frac{μ^2}{2+μ^2}
\]

Γραφικά:

\begin{tikzpicture}
\def\c{gray!50!black}
\draw (0,0) -- (4,0) node[below] {$μ$};
\draw (0,-0.5) -- (0,4) node[left] {Ισχύς \%};

\draw[\c,thin] (3,-0.5) -- (3,4);

\draw (0,0) node [below left] {$0$};
\draw (3,0) node [below left] {$1$};

\draw[\c,thin] (0,1) node[left] {$\sfrac{1}{3}$} -- (4,1);
\draw[\c,thin] (0,2) node[left] {$\sfrac{2}{3}$} -- (4,2);
\draw[\c,thin] (0,3) node[left] {$\sfrac{3}{3}$} -- (4,3);

\draw[gray,dashed] (0.2*3,-0.4) node[right,scale=.8] {$0.2=20\%$} -- (0.2*3,4);
\draw[gray,dashed] (0.2*3,{3*0.2^2/(2+0.2^2)}) -- ++(-0.2*3,0)
node[scale=0.6,left] {$2\%$};

\draw[->,black!80!brown] (1.51,2.67) to[bend left=20] ++(0.5,1.5) node[above right] {Ισχύς φέροντος};
\draw[->,black!80!brown] (2.61,0.82) to[bend right=20] ++(0.8,-0.5) node[right] {
	Ισχύς πλευρικών συνιστωσών};

\draw[very thick,black!80!brown,variable=\m,domain=0:3,samples=\gsamples]
plot ({\m}, {3*(\m/3)^2/(2+(\m/3)^2)});
\draw[very thick,black!80!brown,variable=\m,domain=0:3,samples=\gsamples]
plot ({\m}, {3-3*(\m/3)^2/(2+(\m/3)^2)});
\end{tikzpicture}

Όσο αυξάνουμε το \( μ \), αυξάνεται το ποσοστό της ισχύος που καταναλώνεται για τη μετάδοση
του σήματος και όχι του φέροντος, αλλά η ισχύς του φέροντος συνεχίζει να είναι μεγάλη.

\subsubsection{Διαμορφωτής AM}
Ένα ερώτημα που προκύπτει είναι ποιό κύκλωμα θα πραγματοποιήσει τον πολλαπλασιασμό του
σήματος με το φέρον. Για αυτό παρουσιάζεται το παρακάτω κύκλωμα, που λειτουργεί
ως \textbf{διαμορφωτής AM (διακοπτικός - switching modulator)}:

\begin{circuitikz}[american,scale=1.3]
	\draw (0,0) to[esource,label=$m(t)$] (0,2)
	to[sV,label={$c(t)\equals A_c\cos(2πf_ct)$}] (2,2)
	to[D] (4,2)
	to[R=$R_L$] (4,0)
	-- (0,0);
	
	\draw (2,2) to[open,v=$v_1(t)$,*-*] (2,0);
	\draw (4,2) -- (5,2) to[open,v^=$v_2(t)$,o-o] (5,0) -- (4,0);
\end{circuitikz}

Επίσης απαιτούμε το σήμα \( m(t) \) να έχει \textbf{αρκετά μικρότερο πλάτος} από το φέρον:
\[
\left\lvert  m(t) \right\rvert \ll A_c
\]

Τότε, η τάση \( u_1 \) γίνεται:
\[
u_1(t) = m(t)+A_c \cos(2πf_ct)
\]

%\def\gsamples{700}
\begin{tikzpicture}
\draw (0,0) -- (6,0);
\draw[->] (0,-2) -- (0,3) node[left] {$u_1(t)$};

\draw[very thick,blue!50!black] plot
[variable=\t,domain=0:5,samples=\gsamples,smooth]
(\t,{2*cos(2*\t r)+0.2*cos(43.7*\t r)})
;

\draw[dashed] (2*pi/2,0) node[below] {$\sfrac{1}{f_c}$} -- ++(0,2);
\end{tikzpicture}

Και, αφού θυμηθούμε την καμπύλη λειτουργίας της διόδου, \begin{tikzpicture}[baseline,scale=0.4,every node/.style={scale=.7}]
\draw (-2,0) -- (2,0) node[below] {$u_1(t)$};
\draw[->] (0,-1) -- (0,2) node[above] {$u_2(t)$};

\draw[very thick,blue!50!black] (-2,0) -- (0,0) -- (2,2);
\end{tikzpicture}, ισχύει:
\[
u_2(t) \simeq \begin{cases}
u_1(t), &\quad \text{όταν } c(t) > 0 \\
0,&\quad \text{όταν } c(t) < 0
\end{cases}
\]

Εναλλακτικά, μπορούμε να εκφράσουμε την \( u_2(t) \) ως γινόμενο της
εισόδου \( u_1(t) \) και μιας συνάρτησης \( g_{T_0} \) που μηδενίζεται για \( c(t) <0 \) και
είναι μονάδα για \( c(t) > 0 \), δηλαδή μιας παλμοσειράς:

\begin{center}
\begin{tikzpicture}
\draw (-4.2,0) node[left] {$\cdots$} -- (4.2,0) node[right] {$\cdots$};
\draw[->] (0,-1.5) -- (0,2) node[right] {$g_{T_0}(t)$};

\draw[blue!70!cyan,ultra thick,opacity=.1]
plot[variable=\t,domain=-4.2:4.2,samples=\gsamples]
(\t,{cos(2*pi/3*\t r}) (0,1) node[above left] {$u_1(t)$};

\draw[very thick,draw=teal] (-0.75,0) node[below] {$-\sfrac{T_0}{4}$} -- ++(0,0.8) -- ++(1.5,0) -- ++(0,-0.8) node[below] {$\sfrac{T_0}{4}$} ;
\draw[very thick,draw=teal] (2+0.25,0) node[below] {$\sfrac{3T_0}{4}$} -- ++(0,0.8) -- ++(1.5,0) -- ++(0,-0.8) node[below] {$\sfrac{5T_0}{4}$};
\draw[very thick,draw=teal] (-4+0.25,0) -- ++(0,0.8) -- ++(1.5,0) -- ++(0,-0.8);

\draw (0,0) node[below right] {$0$};
\draw[dashed] (3,0) node[below] {$T_0$} -- ++(0,0.8);
\draw[dashed] (-3,0) node[below] {$-T_0$} -- ++(0,0.8);

\draw (0,0.8) node[above right] {$1$};

\draw (current bounding box.east) node[above right] {$T_0 = \frac{1}{f_c}$};
\end{tikzpicture}
\end{center}
\begin{align*}
	u_2(t) &\simeq
	\left[
	A_c\cos 2π f_c t + m(t)
	\right] \cdot g_{T_0}(t) \\
	g_{T_0(t)} &= \frac{1}{2} + \frac{2}{\pi}
	\sum_{n=1}^\infty \frac{(-1)^{n-1}}{2n+1}\cos[2πf_ct(2n-1)]
	\intertext{Άρα}
	u_2(t) &\simeq
	\left(
	A_c\cos 2πf_ct +m(t
	\right) \cdot \left[
	\frac{1}{2} + \frac{2}{π} \cos\left(
	2πf_ct
	\right)-\frac{2}{π}\frac{1}{3}\cos(2π3f_ct)
	+ \frac{2}{π}\frac{1}{5}\cos(5f_ct)+\dots
	\right]
	\\
	&=
	\frac{A_c}{2}\cos 2 π f_ct
	+ \frac{1}{2}m(t)
	\\ &\hphantom{=}
	+ \frac{2}{π}A_c\cos 2πf_ct + \infoboxed{\frac{2}{π}m(t)\cos 2πf_c t}
	\\ &\hphantom{=}
	-\frac{2}{3π}A_c\cos 2π (3f_c) \cos 2πf_ct - \frac{2}{3π}
	m(t)\cos 2π(3f_ct)+\dots
\end{align*}

Αν σχεδιάσουμε τις συχνότητες που δίνει ο τύπος σε ένα διάγραμμα φάσματος:

\begin{tikzpicture}[scale=1.2]
\draw[->] (0,-2) -- (0,2) node[above] {$U_2(f)$}; % y axis

\draw[orange!40!brown] (-0.5,0) -- (0,0.8) -- (0.5,0);
\draw[orange!20!brown!90!black,very thick,->] (0,0) -- ++(0,1);

\draw[blue!50!green,fill opacity=0.9,fill=green!5!white,blur shadow,shadow xshift=0cm,shadow yshift=0.3mm]
(0.8,0) -- ++(0,1.2) -- ++(1+2*0.2,0) -- ++(0,-1.2);

\begin{scope}[xshift=1.5cm]
\draw[draw=orange!50!brown,thick,every node/.style={scale=.7}]
(-0.5,0) node[below] {$f_c-w$} -- (0,0.8) -- (0.5,0) node[below] {$f_c+w$} ;
\draw[orange!20!brown!90!black,very thick,->] (0,0) node[below,black] {$f_c$} -- ++(0,1);
\end{scope}

\foreach \i in {3,5}
{
	\begin{scope}[xshift={\i*1.5cm}]
	\draw[orange!50!brown,thick] (-0.5,0) -- (0,0.8) -- (0.5,0);
	\end{scope}
}
\foreach \i in {2,3,...,5}
{
	\begin{scope}[xshift={\i*1.5cm}]
	\draw[orange!20!brown!90!black,very thick,->] (0,0) node[below,black] {$\i f_c$} -- ++(0,1);
	\end{scope}
}

\draw (-1,0) -- (9,0); % x axis
\draw (8.2,0.4) node[right] {$\cdots$};

\draw[gray,->,thick] (-1.75,0) to[bend right=20] ++(0.5,0);
\begin{scope}[xshift=-3.5cm]
\draw (-1.5,0) -- (1.5,0);
\draw (0,-2) -- (0,2) node[above] {$M(f)$};

\draw[draw=orange!50!brown,thick,scale=1.7]
(-0.5,0) node[below] {$-w$} -- (0,0.8) -- (0.5,0) node[below] {$w$};
\end{scope}
\end{tikzpicture}

Παρατηρούμε ότι στο φάσμα υπάρχει το επιθυμητό διαμορφωμένο AM σήμα, όπως και ο
πολλαπλασιασμός του \( m(t) \) με το φέρον. Επομένως, με ένα ζωνοπερατό φίλτρο, μπορούμε
να πάρουμε από τις άπειρες συχνότητες μόνο το τελικό φάσμα:
\begin{align*}
u(t) = &\frac{A_c}{2}\left[ 1+\frac{4}{πA_c}m(t) \right]\cos 2π f_c t
\intertext{που αντιστοιχεί στον τύπο:}
A_c\left[ 1+k_am(t) \right] \cos 2πf_c
\end{align*}

δηλαδή το κύκλωμα γίνεται:

\begin{circuitikz}[american,scale=1.3]
	\draw (0,0) to[esource,label=$m(t)$] (0,2)
	to[sV,label={$c(t)\equals A_c\cos(2πf_ct)$}] (2,2)
	to[D] (4,2)
	to[R=$R_L$] (4,0)
	-- (0,0);
	
	\draw (2,2) to[open,v=$v_1(t)$,*-*] (2,0);
	\draw (4,2) -- (5,2) to[open] (5,0) -- (4,0);
	
	% Rectangle
	\draw (5,2.5) rectangle (7,-0.5) node[align=center] (A) at (6,1) {BPF\\{%
			\footnotesize Band Pass Filter}};
	
	\draw (7,2) -- (8,2) to[open,v^=$s(t)$,o-o] (8,0) -- (7,0);
\end{circuitikz}

όπου το Band Pass Filter πρέπει να έχει κέντρο τη συχνότητα \( f_c \) και εύρος ζώνης
από \( f_c - w \) μέχρι \( f_c + w \).

Αυτό ήταν ένα παράδειγμα χρήσης \textit{μη γραμμικών στοιχείων} (δίοδος) για spectral
spread.

\subsubsection{Φωρατής περιβάλλουσας / Αποδιαμορφωτής AM}
Ο φωρατής περιβάλλουσας είναι η συσκευή που μαζεύει τις κορυφές του διαμορφωμένου σήματος
AM ώστε να παράγει το αρχικό σήμα (θυμόμαστε ότι \( s(t) = A_c\left[
1+k_a m(t)
\right] \cos(2π f_c t) \)). Η διαδικασία ονομάζεται κορυφοφώραση, και το κύκλωμα του φωρατή
δεν είναι πολύ διαφορετικό από αυτό του διαμορφωτή:

\begin{circuitikz}[american,scale=1.3,yscale=0.8]
	\draw (0,0) to[esource,l_={$s(t)$},n=sig]
	(0,2) to[R=$R_j$] (0,4)
	to [D={$z_f$},l_=$r_f$] (2,4)
	to [C=$C$] (2,0)
	-- (0,0)
	
	(2,4) to[short] (4,4)
	to[R=$R_l$] (4,0)
	-- (2,0)
	
	(4,4) to[short,-o] (6,4)
	(4,0) to[short,-o] (6,0)
	;
	
	\draw (-1,1) node[rxantenna,xscale=-1] (antenna) {};
	\draw(antenna.1) -- (sig.n);
	
	\draw (6,4) to[open,v=$s(t)$] (6,0);
\end{circuitikz}

\textbf{Πώς λειτουργεί αυτό το κύκλωμα};

Θυμόμαστε ότι η συχνότητα του φέροντος είναι πολύ μεγάλη σε σχέση με τη συχνότητα του
αρχικού σήματος (π.χ. 100 ή παραπάνω φορές μεγαλύτερη).

Η δίοδος αφήνει να περάσει ρεύμα μόνο όταν το σήμα είναι θετικό. Όταν φτάσουμε σε μία
κορυφή της διαμορφωμένης κυματομορφής, ο πυκνωτής φορτίζεται άμεσα, και ξεφορτίζεται πολύ
αργά με μία εκθετική καμπύλη, μέχρι να φτάσει στην επόμενη κορυφή:

\begin{tikzpicture}[scale=1.6]
\draw (0,-2) -- (0,2) node[right] {$s(t)$};
\draw (0,0) -- (6,0);

\def\f{2*3.14*0.22};
\def\fc{2*3.14*3};
\def\sc{1.4}

\draw[thick,green!50!cyan] plot[smooth,domain=0:6,variable=\t,samples=\gsamples,yscale=\sc]
(\t,{sin(\fc*(\t r))*(0.7+0.3*cos(\f*(\t r)))});

\draw[green!50!blue,dashed] plot[smooth,domain=0:6,variable=\t,yscale=\sc,yshift=0.5mm]
(\t,{(0.7+0.3*cos(\f*(\t r)))})
plot[smooth,domain=0:6,variable=\t,yscale=\sc,yshift=-0.5mm]
(\t,{-(0.7+0.3*cos(\f*(\t r)))});

\draw[very thick,blue!75!magenta,yscale=\sc] plot[smooth]
file{data/AM_capacitor.data};

\end{tikzpicture}

Πρακτικά το κύκλωμα χωρίζεται σε δύο κομμάτια. Το αριστερό που περιλαμβάνει τη δίοδο
έχει μικρή σταθερά χρόνου και επηρεάζεται άμεσα από τις κορυφές. Το δεξί έχει μεγάλη σταθερά
χρόνου ώστε να διατηρείται η χαμηλής συχνότητας έξοδος. Ο πυκνωτής που βρίσκεται στη
μέση ανήκει και στα δύο τμήματα. Πρακτικά:
\begin{gather*}
	(R_s+r_f)C \ll \frac{1}{f_C} \\
	\intertext{και}
	\frac{1}{f_C} \ll R_l C \ll \frac{1}{w}
\end{gather*}

Για να μην υπάρχουν οι συχνότητες που προκύπτουν από την εκθετική πτώση της τάσης του
πυκνωτή ανάμεσα στις κορυφές, μπορούμε να τοποθετήσουμε στο τέλος του κυκλώματος ένα
χαμηλοπερατό φίλτρο.

\begin{circuitikz}[american,scale=1.3,yscale=0.8]
	\draw (0,0) to[esource,l_={$s(t)$},n=sig]
	(0,2) to[R=$R_j$] (0,4)
	to [D={$z_f$},l_=$r_f$] (2,4)
	to [C=$C$] (2,0)
	-- (0,0)
	
	(2,4) to[short] (4,4)
	to[R=$R_l$] (4,0)
	-- (2,0)
	
	(4,4) to[short] (5,4)
	(4,0) to[short] (5,0)
	
	(7,4) to[short,-o] (8,4)
	(7,0) to[short,-o] (8,0)
	;
	
	\draw (-2,1) node[rxantenna,xscale=-1] (antenna) {};
	\draw(antenna.1) -- (sig.n);
	
	\draw (5,4.5) rectangle (7,-0.5) node[align=center] (A) at (6,2) {LPF\\{%
			\footnotesize Low Pass Filter}};
\end{circuitikz}

Επίσης, μπορούμε να χρησιμοποιήσουμε ένα φίλτρο που κόβει τον DC όρο,
ώστε από την τιμή \( 1+k_am(t) \) του αρχικού σήματος να καταλήξουμε στην επιθυμητή
\( k_a m(t) \). Για παράδειγμα, σε μια κυματομορφή που παριστάνει ήχο, μπορούμε να
κόψουμε τις συχνότητες κάτω από 20 Hz, μαζί με το χαμηλοπερατό φίλτρο που
τοποθετήσαμε παραπάνω:

\begin{tikzpicture}[scale=1.2]
\draw[->] (-3,0) -- (3,0) node[below right] {Hz}; % x axis
\draw (0,0) -- (0,2);


\draw[orange!50!brown,very thick] plot[smooth,tension=1] coordinates {(-0.8,0) (-0.425,0.7) (-0.05,0)};
\draw[orange!50!brown,very thick] plot[smooth,tension=1] coordinates {(0.8,0) (0.425,0.7) (0.05,0)};

\draw (0.05,0) node[below,scale=0.5] {20};
\draw (0.8,0) node[below,scale=0.5] {20k};

\draw[orange!20!brown!90!black,very thick,->] (2,0) node[below,black] {$f_c$} -- ++(0,1.5);
\draw[orange!20!brown!90!black,very thick,->] (-2,0) node[below,black] {$-f_c$} -- ++(0,1.5);

\draw[thick,black!80!green] (-1,0) -- ++(0,1) -- (1,1) -- (1,0);
\draw[thick,black!70!green] (0.03,0) -- ++(0.3,1.3) -- ++(0.5,0) edge[path fading=east] ++(0.8,0);
\draw[thick,black!70!green,xscale=-1] (0.03,0) -- ++(0.3,1.3) -- ++(0.5,0) edge[path fading=west] ++(0.8,0);
\end{tikzpicture}

\paragraph{Πρόβλημα 1: Αργός πυκνωτής}
Αν ο πυκνωτής είναι πολύ αργός, μπορεί να μην προλάβει να έχει κατέβει αρκετά μέχρι την
επόμενη κορυφή, και έτσι να χαθεί κάποια πληροφορία του σήματος:

\begin{tikzpicture}[scale=1.2]
\draw (0,-2) -- (0,2) node[right] {$s(t)$};
\draw (0,0) -- (6,0);

\def\f{2*3.14*0.22};
\def\fc{2*3.14*3};
\def\sc{1.4}

\draw[thick,green!80!cyan] plot[smooth,domain=0:6,variable=\t,samples=\gsamples,yscale=\sc]
(\t,{sin(\fc*(\t r))*(0.5+0.45*cos(\f*(\t r)))});

\draw[green!50!blue,dashed] plot[smooth,domain=0:6,variable=\t,yscale=\sc,yshift=0.5mm]
(\t,{(0.5+0.45*cos(\f*(\t r)))})
plot[smooth,domain=0:6,variable=\t,yscale=\sc,yshift=-0.5mm]
(\t,{-(0.5+0.45*cos(\f*(\t r)))});

\draw[very thick,blue!75!magenta,yscale=\sc] plot[smooth]
file{data/AM_capacitor_2.data};
\end{tikzpicture}

Αυτό μπορεί να διορθωθεί βλέποντας ποιά είναι η μέγιστη ταχύτητα μεταβολή του σήματος, και
ρυθμίζοντας ανάλογα τις σταθερές της διαμόρφωσης και του αποδιαμορφωτή, ώστε να μην υπάρχει
περίπτωση κάποια κορυφή του AM να είναι κάτω από την τάση του πυκνωτή κάθε στιγμή.

\paragraph{Πρόβλημα 2: Υπερδιαμόρφωση}

Αν το αρχικό σήμα έχει πολύ μεγάλο πλάτος, δηλαδή
αν \( \left| k_a m(t) \right| > 1 \), τότε η αποδιαμόρφωση δεν θα δώσει το επιθυμητό
αποτέλεσμα, όπως είχαμε αναφέρει και παραπάνω:

\begin{tikzpicture}[scale=1.1]
\draw (0,-2) -- (0,2) node[right] {$s(t)$};
\draw (0,0) -- (6,0);

\def\f{2*3.14*0.22};
\def\fc{2*3.14*5};
\def\sc{1.4}

\draw[very thick,green!50!cyan] plot[smooth,domain=0:6,variable=\t,samples=\gsamples,yscale=\sc]
(\t,{sin(\fc*(\t r))*(0.2+0.8*cos(\f*(\t r)))});

\draw[thick,green!50!blue,dashed] plot[smooth,domain=0:6,variable=\t,yscale=\sc]
(\t,{(0.2+0.8*cos(\f*(\t r)))})
plot[smooth,domain=0:6,variable=\t,yscale=\sc]
(\t,{-(0.2+0.8*cos(\f*(\t r)))});
\end{tikzpicture}

Αυτό μπορεί να διορθωθεί με διαφορετική επιλογή της σταθεράς \( k_a \), έτσι ώστε \( 1 + k_am(t) \geq 0 \).

\subsubsection{Και άλλοι αποδιαμορφωτές}
Ο παραπάνω αποδιαμορφωτής, όπως και ο διαμορφωτής, λειτουργεί με χρήση ενός μη γραμμικού
στοιχείου, της διόδου.

\begin{tikzpicture}[baseline,scale=0.7,every node/.style={scale=.7}]
\draw (-2,0) -- (2,0) node[below] {$u_1(t)$};
\draw[->] (0,-1) -- (0,2) node[above] {$u_2(t)$};

\draw[very thick,blue!50!black] (-2,0) -- (0,0) -- (2,2);
\draw[very thick,blue!70!black] plot[variable=\x,domain=0:2,samples=\gsamples]
(\x,{\x*\x/1.7});
\end{tikzpicture}

Η συμπεριφορά της διόδου μπορεί να προσεγγιστεί με μια σχέση της μορφής \( y= ax^2+b \).
Οπότε, ας εξετάσουμε ένα σύστημα που εξάγει το τετράγωνο μιας κυματομορφής:

\begin{tikzpicture}[scale=1]
\draw (0,0) node[rectangle,draw,inner sep=5pt] (DM) {αποδιαμορφωτής τετραγωνικού νόμου};
\draw (DM.west) -- ++(-1,0) node[above right] {$u_1$};
\draw (DM.east) -- ++(1,0) node[above left] {$u_2$};

\draw (current bounding box.south)
node[below,yshift=-3mm] {$u_2(t) = a_1u_1(t) + a_2u_1^2(t)$};
\end{tikzpicture}

Γενικά, τέτοια μη γραμμικά συστήματα παράγουν πολλές συχνότητες, και μία από αυτές ίσως είναι
αυτή που επιθυμούμε.

Θα πραγματοποιήσουμε μια ανάλυση παρόμοια με τον διαμορφωτή, μελετώντας την έξοδο
του παραπάνω συστήματος στο πεδίο συχνότητας:

\todo{infobox importants}
\begin{align*}
	u_1(t) &= s(t) = A_c\left[ 1+k_am(t) \right]\cos(2π f_c t) \\
	u_2(t) &= a_1A_c\left[1+k_am(t)^2\right]\cos 2πf_c t
	+ a_2A_c^2\left[ 1+k_a m(t) \right]^2 \cos^2 2πf_c t \\
	&=             {\color{orange!20!brown!70!black} a_1A_c \cos 2πf_ct} \\
	&\hphantom{=} +{\color{cyan!80!black}            a_1A_ck_am(t)\cos 2πf_c t} \\
	&\hphantom{=} +{\color{orange!20!brown!70!black} a_2\frac{A_c^2}{2}} \\
	&\hphantom{=} +{\color{blue!80!black}            2a_2\frac{A_c^2}{2}k_a m(t)} \\
	&\hphantom{=} +{\color{magenta!80!black}         a_2\frac{A_c^2}{2}k_a^2 m^2(t)} \\
	&\hphantom{=} +{\color{cyan!80!black}            a_2\frac{A_c^2}{2}\cos 2π2f_c t} \\
	&\hphantom{=} +{\color{cyan!80!black}            a_2\frac{A_c^2}{2} k_a m(t) \cos 2π2f_ct} \\
	&\hphantom{=} +{\color{magenta!80!black}         a_2\frac{A_c^2}{2}k_a^2 m^2(t) \cos 2π2f_ct}
\end{align*}

Από μία ύψωση στο τετράγωνο δηλαδή προκύπτουν πολλές καινούριες συχνότητες:

\begin{tikzpicture}[scale=1.1,yscale=1.4]
\draw[->] (-2.5,0) -- (12.5,0) node[below right] {f};
\draw[->] (0,-1) -- (0,2) node[right] {$Y_2(f)$};

\draw (0,0) node[below right] {$0$};
\draw (1,0) node[below] {$\vphantom{2}w$};
\draw (2,0) node[below] {$2w$};
\draw (-1,0) node[below] {$-\vphantom{2}w$};
\draw (-2,0) node[below] {$-2w$};

\begin{scope}
\clip (-1,0) -- (0,1) -- (1,0);
\fill[red!50!green, opacity=.4, postaction={pattern=north east lines}] plot[smooth]
coordinates {(-2,0) (-1,0.4) (1,0.4) (2,0)};
\end{scope}

\begin{scope}
\clip plot[smooth]
coordinates {(-2,0) (-1,0.4) (1,0.4) (2,0)};
\fill[even odd rule,orange!90!green, opacity=.2, postaction={pattern=north west lines}] plot[smooth]
coordinates {(-2,0) (-1,0.4) (1,0.4) (2,0)} (-1,0) -- (0,1) -- (1,0);
\end{scope}

\draw[orange!20!brown!90!black,very thick,->] (0,0)  -- ++(0,1.5);
\draw[blue!80!black,very thick] (-1,0) -- (0,1) node[right] {$m(f)$} -- (1,0);
\draw[magenta!90!blue, very thick] plot[smooth] 
coordinates {(-2,0) (-1,0.4) (1,0.4) (2,0)} (1,0.3) node[above right] {$m^2(f)=m*m$};

\begin{scope}[xshift=5cm]
\draw[orange!20!brown!90!black,very thick,->] (0,0) node[below,black] {$f_c$} -- ++(0,1.5);
\draw[cyan!80!black,very thick] (-1,0) -- (0,1)  -- (1,0);
\end{scope}

\begin{scope}[xshift=10cm]
\draw[orange!20!brown!90!black,very thick,->] (0,0) node[below,black] {$2f_c$} -- ++(0,1.5);
\draw[cyan!80!black,very thick] (-1,0) -- (0,1)  -- (1,0);
\draw[magenta!90!blue, very thick] plot[smooth] 
coordinates {(-2,0) (-1,0.4) (1,0.4) (2,0)} (1,0.3);
\end{scope}
\end{tikzpicture}

Φαίνεται, όπως είδαμε και στο προηγούμενο κύκλωμα, ο DC όρος στο \( f=0 \), τα ripples στις
υψηλότερες συχνότητες, αλλά και μία παραμόρφωση που οφείλεται στον όρο \( m^2(t) \), η
οποία, αφού προκύπτει από συνέλιξη του \( m(t) \) (εύρος ζώνης \( w \)) με τον εαυτό του,
έχει εύρος ζώνης:
\[
a_2\frac{A_c^2}{2}k_a^2 m^2(t)
\]

Για να μειωθεί η παραμόρφωση αυτή, πρέπει να μειώσουμε τον όρο \( k_a^2m^2(t) \), ή ισοδύναμα
τον \( k_a m(t) \):
\[
k_a^2m^2(t) \ll k_am(t) \ll 1
\]

\subsection{DSB-SC}
\label{dsb-sc}
\subsubsection{Στο δρόμο για την κατανάλωση λιγότερης ισχύος}
Θυμόμαστε το σήμα:
\begin{align*}
	s(t) &=
	A_c\left[1+k_a m(t)\right]\cos 2πf_c t
	\\
	&= \underbrace{A_c \cos 2π f_c t} + A_c k_a m(t) \cos 2π f_c t
\end{align*}

Τι γίνεται αν αφαιρέσουμε τον όρο \( A_c \cos 2πf_c t \), ο οποίος
δεν περιέχει πληροφορία, αλλά καταναλώνει μόνο παραπάνω ισχύ (θυμόμαστε
ότι ο όρος αυτός υπάρχει για την αποδιαμόρφωση);

Τότε θα πάρουμε ένα άλλο σήμα:
\[
\boxed{s(t) = A_c m(t) \cos 2π f_c t}
\]
το οποίο ονομάζουμε διαμορφωμένο κατά \textbf{DSB-SC} (Double Side Band - Supressed Carrier).

Μετασχηματισμένο κατά Fourier:
\[
S(f) =
\frac{1}{2} A_c \left[
M(f-f_c) + M(f+f_c)
\right]
\]

Δηλαδή το σήμα εξόδου αποτελείται από το αρχικό σήμα, μετατοπισμένο
μόνο κατά τη συχνότητα:

\begin{center}
\begin{tikzpicture}[scale=1]
\draw[draw=orange!50!brown,very thick]
(-0.8,0) node[below] {$-w$}
-- (0,1.4) node[right] {$M(0)$}
-- (0.8,0) node[below] {$w$}
;

\draw (-2,0) -- (2,0);
\draw (0,-0.5) -- (0,2.5) node[right] {$M(f)$};

\draw[->,very thick, blue!60!black]
(2.5,1.25) -- ++(2,0);

\begin{scope}[xshift=9cm]
\draw[xshift=-2cm,draw=brown!50!orange,very thick,every node/.style={scale=.9}]
(-0.8,0)
-- (0,1.4)
-- (0.8,0)
(0,0) node[below] {$-f_c$}
;
\draw[xshift=2cm,draw=brown!50!orange,very thick]
(-0.8,0)
-- (0,1.4)
-- (0.8,0)
(0,0) node[below] {$f_c$}
;

\draw (-4,0) -- (4,0);
\draw[->] (0,-0.5) -- (0,2.5) node[right] {$S(f)$};

\draw[dashed] (-2.1,1.4) --++(4.2,0);
\draw (0,1.4) node[above right] {$\sfrac{1}{2}A_cM(0)$};
\end{scope}
\end{tikzpicture}
\end{center}


Στο πεδίο του χρόνου, το σήμα φαίνεται κάπως έτσι:

\begin{tikzpicture}[scale=1.1]
\draw (0,-2) -- (0,2);
\draw (0,0) -- (6,0);

\def\f{2*3.14*0.22};
\def\fc{2*3.14*5};
\def\sc{1.4}

\draw[very thick,blue!50!black] plot[smooth,domain=0:6,variable=\t,samples=\gsamples,yscale=\sc]
(\t,{(1-0.1*\t)*sin(\fc*(\t r))*(0.2+0.8*cos(\f*(\t r)))});

\draw[thick,green!50!blue] plot[smooth,domain=0:6,variable=\t,yscale=\sc*1.1]
(\t,{(1-0.1*\t)*(0.2+0.8*cos(\f*(\t r)))});
\draw[thick,green!80!cyan] plot[smooth,domain=0:6,variable=\t,yscale=\sc*1.1]
(\t,{-(1-0.1*\t)*(0.2+0.8*cos(\f*(\t r)))});
\end{tikzpicture}


Παρατηρούμε την αρχική κυματομορφή, η οποία αποκτά και αρνητικές τιμές,
με αποτέλεσμα η χρήση του αποδιαμορφωτή AM που χρησιμοποιήσαμε και
προηγουμένως να μην είναι εφικτή.

Στην πραγματικότητα, ο σχεδιασμός ενός αποδιαμορφωτή AM είναι
πιο δύσκολος.

\subsubsection{Αποδιαμορφωτής}
\label{dsbsc.demodulator}

Σχεδιάζουμε το κύκλωμα του αποδιαμορφωτή ως έναν πολλαπλασιαστή
του φέροντος με το διαμορφωμένο σήμα, φροντίζοντας να μην ξεχάσουμε
το δικό μας φέρον να έχει την \textbf{κατάλληλη φάση} \( φ \) που να αντιστοιχεί
στη φάση του φέροντος του λαμβανόμενου σήματος:

\begin{circuitikz}[scale=2]
	\draw (0,0) node[xshift=4.9mm,oscillator] (osc) {}
	node[above right,xshift=5mm] {$A_c' \cos(2πf_c t + φ)$};
	\draw (0,1) node[rectangle,draw,minimum width=15mm,minimum height=10mm] (mult) {}
	node[scale=1.5] {$\times$};
	
	\draw[<-] (mult.west) -- ++(-1,0) node[above,midway] {$s(t)$};
	\draw[->] (mult.east) -- ++(1,0) node[above,midway] {$u(t)$};
	\draw[->] (osc.north) -- (mult.south);
\end{circuitikz}

Τότε, με λίγα μαθηματικά έχουμε:
\begin{align*}
	u(t) &=
	s(t)\cdot c(t) =
	A_c \cos(2π f_c t + φ)A_C m(t)\cos(2πf_c t)
	\\ &=
	\frac{1}{2} A_c A_c'
	m(t) \cos(2π2f_ct + φ) + \frac{1}{2}A_cA_c' m(t)\cos φ
\end{align*}
Και, εφαρμόζοντας ένα φίλτρο LPF που κόβει τις υψηλές συχνότητες \( 2π2f_c \):
\begin{tikzpicture}[scale=0.3,baseline]
\filldraw[fill=green!80!black,fill opacity=.1] (-1.2,0) -- (-1,1.8) -- (1,1.8) -- (1.2,0);

\draw[draw=blue!50!brown,very thick]
(-0.8,0)
-- (0,1.4)
-- (0.8,0)
;

\draw[draw=red,opacity=.8,xshift=3cm,thick]
(-0.8,0)
-- (0,1.4)
-- (0.8,0)
;

\draw[draw=red,opacity=.8,xshift=-3cm,thick]
(-0.8,0)
-- (0,1.4)
-- (0.8,0)
;

\draw (-5,0) -- (5,0);
\draw (0,-0.5) -- (0,2.5);
\end{tikzpicture}%
\begin{align*}
	\left. u(t) \right\lvert_{\mathrm{LPF}}
	&= \frac{1}{2} A_c A_c' m(t) \cos φ
\end{align*}

Στο τελικό αποτέλεσμα έχουμε το επιθυμητό \( m(t) \), και έναν
όρο \( \boxed{\cos φ} \). Όταν η γωνία \( φ \) (που εκφράζει τη διαφορά
φάσης μεταξύ του φέροντος του δέκτη και του πομπού) είναι 0, τότε
\( \cos φ = 1 \), και το σήμα έχει πλήρες πλάτος. Όταν έχουμε
\( φ = \pm \frac{π}{2} \) όμως, ο διαμορφωτής και ο
αποδιαμορφωτής δεν είναι συγχρονισμένοι, και δεν παίρνουμε καθόλου
σήμα.

Ο λόγος που ήταν δύσκολο να υλοποιηθούν τέτοια κυκλώματα ήταν
η έλλειψη φθηνών κυκλωμάτων συγχρονισμού τα οποία μπορούν να παρακολουθήσουν
τη φάση \( φ \). Η φάση του φέροντος μπορεί να επηρεαστεί από
εμπόδια που υπάρχουν στη διαδρομή του κύματος, κάτι που οδηγούσε και
στα φαινόμενα των \textit{διαλείψεων} στα παλιότερα ραδιόφωνα.
Για συγχρονισμό της φάσης μπορεί να χρησιμοποιηθεί ένα σύστημα
αυτομάτου ελέγχου PLL (Phase-Locked Loop).

Τελικά, το κύκλωμα προκύπτει:

\begin{circuitikz}[scale=2]
	\draw (0,0) node[xshift=4.9mm,oscillator] (osc) {}
	node[above right,xshift=5mm] {$A_c' \cos(2πf_c t + φ)$};
	\draw (0,1) node[rectangle,draw,minimum width=15mm,minimum height=10mm] (mult) {}
	node[scale=1.5] {$\times$};
	\draw (1.3,1) node[rectangle,draw,minimum width=15mm,minimum height=10mm] (lpf) {}
	node[] {LPF};
	
	\draw[<-] (mult.west) -- ++(-1,0) node[above,midway] {$s(t)$};
	\draw(mult.east) -- (lpf.west);
	\draw[->] (lpf.east) -- ++(0.5,0);
	\draw[->] (osc.north) -- (mult.south);
\end{circuitikz}

\subsubsection{Δακτυλιοειδής διαμορφωτής (ring modulator)}
Προκύπτει το ερώτημα πώς μπορούμε να υλοποιήσουμε κυκλωματικά
έναν πολλαπλασιαστή. Έστω λοιπόν ότι θέλουμε να πολλαπλασιάσουμε
ένα σήμα \( m(t) \) με ένα φέρον \( A_c\cos2π f_ct \).

Για αυτόν τον λόγο υπάρχει ένα κύκλωμα που ονομάζεται
\textbf{δακτυλιοειδής διαμορφωτής (ring modulator)}, με είσοδο
το \( m(t) \) και μια τετραγωνική κυματομορφή \( c(t) \) συχνότητας
\( f_c \):

\begin{circuitikz}[scale=1,american]
	\draw (0,0) node[transformer core] (t1) {};
	\draw (6,0) node[transformer core] (t2) {};
	
	\draw (t1.A1) to[open,v=$m(t)$] (t1.A2);
	\draw (t2.B1) to[open,v^=$s(t)$] (t2.B2);
	
	\draw (t1.B1) node[above] {$a$} to[diode,*-*] (t2.A1);
	\draw (t2.A1) node[above] {$b$} to[diode] ($(t2.A1)!0.6!(t1.B2)$) -- (t1.B2);
	\draw (t1.B2) node[below] {$c$} to[diode,*-*] (t2.A2);
	\draw (t2.A2) node[below] {$d$} --
	($(t2.A2)!0.48!(t1.B1)$) to[bend left=90] ($(t2.A2)!0.525!(t1.B1)$)
	to[diode] ($(t2.A2)!0.9!(t1.B1)$) 
	-- (t1.B1);
	
	\coordinate (C1) at ($(t1.B1)!0.5!(t1.B2) - (0.4,0)$);
	\coordinate (C2) at ($(t2.A1)!0.5!(t2.A2) + (0.4,0)$);
	
	\def\m{0.2}
	\def\h{2.5}
	\def\l{1.7}
	\draw (C1) to[short,*-] ++(\m,0) -- ++(0,-\h) to[short,-*] ++(\l,0) node (l1) {};
	\draw (C2) to[short,*-] ++(-\m,0) -- ++(0,-\h) to[short,-*] ++(-\l,0) node (l2) {};
	\draw (l1) to[open,v=$c(t)$] (l2);
\end{circuitikz}

Αυτό το κύκλωμα ουσιαστικά εναλλάσει την αλλαγή ή όχι του προσήμου
της κυματομορφής εισόδου:

\begin{tikzpicture}[scale=0.7]
\pgfmathdeclarefunction{mysquare}{1}{%
	\pgfmathparse{int(mod(4*#1,2))}%
	\ifnum\pgfmathresult>0 \pgfmathparse{-1}\else\pgfmathparse{1}\fi%
}

\draw (0,0) -- (5,0);
\draw (0,-2) -- (0,2) node[above right] {$c(t)$};

\def\step{0.25}
\def\ampl{1.8}
\foreach \x in {0,0.5,...,4.5} {
	\draw[thick,blue] (\x,\ampl) -- ++(\step,0) -- ++(0,-2*\ampl) -- ++(\step,0) -- ++(0,2*\ampl);
}

\draw[orange!50!brown!50!black,<->,yshift=-2mm] (0,0) -- (2*\step,0) node[midway,below,scale=.8] {$\sfrac{1}{f_c}$};

\begin{scope}[xshift=6cm]
\draw (0,0) -- (5,0);
\draw (0,-2) -- (0,2) node[above right] {$m(t)$};

\draw[very thick,blue!50!black] plot [variable=\x,domain=0:5,samples=\gsamples] (\x,{1.5*cos(\x r)});
\end{scope}

\begin{scope}[xshift=12cm]
\draw (0,0) -- (5,0);
\draw (0,-2) -- (0,2) node[above right] {$s(t)$};

\draw[blue!50!black,densely dashed,opacity=.9]
plot [variable=\x,domain=0:5,samples=\gsamples] (\x,{1.5*cos(\x r)})
plot [variable=\x,domain=0:5,samples=\gsamples] (\x,{-1.5*cos(\x r)});

\draw[very thick,orange!50!red] plot [variable=\x,domain=0:5,samples=\gsamples]
(\x,{mysquare(\x)*1.5*cos(\x r)});
\end{scope}
\end{tikzpicture}

Πρακτικά, πολλαπλασιάζει το \( c(t) \) με το \( m(t) \). Μαθηματικά,
παίρνουμε τη σειρά Fourier του \( c \) και βλέπουμε:
\begin{align*}
	c(t) &= \frac{4}{π}
	\sum_{n=1}^{\infty}
	\frac{(-1)^{n-1}}{2n-1}\cos\left[
	2πf_c(2n-1)t
	\right] \implies \\
	m(t)c(t) &= \frac{4}{π}m(t)
	\sum_{n=1}^{\infty}
	\frac{(-1)^{n-1}}{2n-1}\cos\left[
	2πf_c(2n-1)t
	\right]
\end{align*}

Ακριβώς όπως μελετήσαμε τον διαμορφωτή και τον αποδιαμορφωτή AM,
ίσως μέσα στις συχνότητες της παραπάνω συνάρτησης υπάρχει και το
σήμα που θέλουμε:
\begin{align*}
	n=1\qquad & \infoboxed{m(t)\frac{4}{π}\cos2πf_c t} \qquad \leftarrow \text{το επιθυμητό σήμα} \\
	n=2\qquad & m(t)\frac{4}{π}\cos2π3f_c t\\
	n=3\qquad & m(t)\frac{4}{π}\cos2π5f_c t
\end{align*}

\begin{tikzpicture}[scale=1]
\filldraw[fill=blue!80!black,fill opacity=.1]
(1.5-0.8,0) -- (1.5-0.7,1.8)
to node[midway,above,opacity=1,black] {BPF} (1.5+0.7,1.8) -- (1.5+0.8,0);

\draw[dashed] (1.5,0) node[below] {$f_c$}-- ++(0,1.4);
\draw[draw=orange!90!brown!80!black,opacity=.8,xshift=1.5cm,very thick] (-0.6,0) -- (0,1.4) -- (0.6,0);

\draw[dashed] (3.5,0) node[below] {$3f_c$}-- ++(0,1.4);
\draw[draw=orange!70!brown!70!black,opacity=.8,xshift=3.5cm,thick] (-0.6,0) -- (0,1.4) -- (0.6,0);

\draw[dashed] (5.5,0) node[below] {$5f_c$}-- ++(0,1.4);
\draw[draw=orange!70!brown!70!black,opacity=.8,xshift=5.5cm,thick] (-0.6,0) -- (0,1.4) -- (0.6,0);

\draw (6.3,0.7) node[right] {$\cdots$};

\begin{scope}[xscale=-1]
\filldraw[fill=blue!80!black,fill opacity=.1]
(1.5-0.8,0) -- (1.5-0.7,1.8)
to (1.5+0.7,1.8) -- (1.5+0.8,0);

\draw[dashed] (1.5,0) node[below] {$-f_c$}-- ++(0,1.4);
\draw[draw=orange!70!brown!70!black,opacity=.8,xshift=1.5cm,thick] (-0.6,0) -- (0,1.4) -- (0.6,0);

\draw[dashed] (3.5,0) node[below] {$-3f_c$}-- ++(0,1.4);
\draw[draw=orange!70!brown!70!black,opacity=.8,xshift=3.5cm,thick] (-0.6,0) -- (0,1.4) -- (0.6,0);

\draw[dashed] (5.5,0) node[below] {$-5f_c$}-- ++(0,1.4);
\draw[draw=orange!70!brown!70!black,opacity=.8,xshift=5.5cm,thick] (-0.6,0) -- (0,1.4) -- (0.6,0);

\draw (6.3,0.7) node[left] {$\cdots$};
\end{scope}

\draw (-6.3,0) -- (6.3,0);
\draw (0,-0.5) -- (0,2.5);
\end{tikzpicture}

Επομένως, παίρνουμε ένα band pass φίλτρο μόνο για τις συχνότητες
του \( n=1 \) και προκύπτει η ζητούμενη έξοδος \( m(t)\frac{4}{π}
\cos2πf_c t \).

Τέτοιου είδους κυκλώματα, σε συνδυασμό με το Band Pass Filter, είναι
διαθέσιμα στο εμπόριο και ονομάζονται \textbf{μίκτες (mixers)}.

Να σημειωθεί βέβαια πως για να λειτουργήσει σωστά αυτή η διάταξη,
πρέπει το κύκλωμα και τα χαρακτηριστικά των στοιχείων του
(δίοδοι, μετασχηματιστές) να είναι συμμετρικά.

Εναλλακτικά, μπορεί να χρησιμοποιηθεί για το ίδιο αποτέλεσμα
ένα κύκλωμα που ονομάζεται double-balanced modulator και λειτουργεί
με δύο όμοιους διαμορφωτές AM:

\begin{circuitikz}[scale=0.7]
	\draw(-1,0) node[oscillator,xshift=4.9mm] (osc) {};
	\draw (2,2) node[draw,rectangle,align=left,inner sep=5pt,scale=.7] (am1) {AM\\διαμορφωτής};
	\draw (2,-2) node[draw,rectangle,align=left,inner sep=5pt,scale=.7] (am2) {AM\\διαμορφωτής};
	\draw (5,0) node[draw,circle,scale=1.4,thick] (add) {$+$};
	\draw (-1,-2.2) node[draw,rectangle] (o1) {$-1$};
	\draw (0,-1) node[draw,rectangle] (o2) {$-1$};
	
	\draw[->] (-3,2.2) -- (am1.west |- 0,2.2);
	\draw[<-] (o1.west) -- ++(-1,0) -- ++(0,2.2+2.2) node[circ] {};
	\draw[->] (o1.east) -- (am2.west |- 0,-2.2);
	\draw[->] (osc.east) -| (o2.north);
	\draw[->] (o2.south) |- (am2.west |- 0,-1.8);
	\draw[->] (osc.north) |- (am1.west |- 0,1.8);
	\draw[->] (am1.east) -| (add.north);
	\draw[->] (am2.east) -| (add.south);
	\draw[->] (add.east) -- ++(1,0);
\end{circuitikz}

\subsubsection{Δέκτης Costas}
Θυμόμαστε ότι για ένα σήμα:
\[
s(t) = A_cm(t) \cdot \cos(2πf_ct + φ)
\]
μπορούμε εύκολα να βρούμε τον όρο \( A_c' \cos (2πf_ct) \), αλλά όχι
τον όρο \( A_c'\cos(2πf_c t + φ) \) (εκτός ίσως αν τον επανεκπέμψουμε μόνο του από την πλευρά του πομπού με διαφορετική, π.χ διπλάσια συχνότητα, κάτι που δεν εφαρμόζεται επειδή καταναλώνονται κι άλλες
συχνότητες).

Σχεδιάζουμε έναν νέο δέκτη, ο οποίος αποτελείται από δύο απλούς
αποδιαμορφωτές της ενότητας \ref{dsbsc.demodulator}:

\begin{circuitikz}[scale=1.1]
	\draw (0,-0.75) node[draw,rectangle] (ps) {$-90\degree$};
	\draw (0,2) node[draw,rectangle,scale=2,outer sep=0] (m1) {$\times$};
	\draw (0,-2) node[draw,rectangle,scale=2, outer sep=0] (m2) {$\times$};
	\draw (3,0) node[draw,rectangle,inner sep=5pt] (osc) {Ταλαντωτής}
	node[below,yshift=-3.5mm,scale=.7] {ελεγχόμενος από τάση};
	\draw (2,2) node[draw,rectangle,inner sep=5pt] (lpf1) {LPF};
	\draw (2,-2) node[draw,rectangle,inner sep=5pt] (lpf2) {LPF};
	\draw (6.5,0) node[draw,rectangle,inner sep=5pt,align=center] (pd) {Διευκρινιστής\\φάσης};
	
	\coordinate (M) at (-2,0);
	
	\draw (M) -- ++(-3,0) node[midway,above] {$A_m(t)\cos(2πft)$};
	\draw[->] (M) |- node[above right,blue!50!black] {\textbf{I}} (m1.west);
	\draw[->] (M) |- node[below right,blue!50!black] {\textbf{Q}} (m2.west);
	\draw[->] (osc) -| (m1);
	\draw[->] (osc) -| (ps) -- (m2);
	\draw[->] (m1) -- (lpf1);
	\draw[->] (lpf1) -| (pd);
	\draw[->] (m2) -- (lpf2);
	\draw[->] (lpf2) -| (pd);
	\draw[->] (pd) -- (osc);
	
	\draw (osc.north east) node[right,xshift=-1mm,yshift=2mm,orange!50!brown!50!black]
	{$\overbrace{-\phi}^{\mathclap{\text{αρνητική ανάδραση}}}$};
	\draw[blue!80!cyan,<-] ($(pd.south)!0.5!(pd.south east)$) to[bend right] ++(0.7,-0.5) node[right,scale=.9,align=center]
	{Διαιρεί τα σήματα\\$\frac{\cos\phi}{\sin\phi}=\tan\phi$};
	
	\draw[->] (pd.north |- lpf1.east) -- ++(1.5,0);
	\draw[->] (pd.south |- lpf2.east) -- ++(1.5,0);
	
	\path (lpf1) -- (pd |- lpf1) node[midway,above] {$\sfrac{1}{2}A_c\cos\phi\; m(t)$};
	\path (lpf2) -- (pd |- lpf2) node[midway,below] {$\sfrac{1}{2}A_c\sin\phi\; m(t)$};
	\path (osc -| ps) -- (m1.south) node[midway,right] {$\cos(2πf_ct)$};
	\path (ps.south) -- (m2.north) node[midway,right] {$\sin(2πf_ct)$};
\end{circuitikz}

Ο δέκτης αυτός ονομάζεται \textbf{δέκτης Costas}, και αποτελείται
από έναν ταλαντωτή \( \cos(2π f_c t + φ) \), και δύο κλάδους
αποδιαμορφωτών, από τους οποίους ο ένας πολλαπλασιάζεται με φέρον
φάσης \( φ \), και ο δεύτερος με φέρον φάσης \( φ-90\degree \).
Στη συνέχεια, τα δύο σήματα διαιρούνται ώστε να βρούμε τη γωνία
\( φ \approx \tan φ = \frac{\cos φ}{\sin φ}
= \frac{\sfrac{1}{2}A_c \cos φ m(t) }{\sfrac{1}{2} A_c \sin φ m(t) } \). Η γωνία αυτή πηγαίνει ως είσοδος στον ταλαντωτή, έτσι ώστε να
διορθωθεί η φάση του σήματος που δίνει ως έξοδο μέσω μιας διαδικασίας
αρνητικής ανάδρασης.

\subsection{QAM}
Έστω ότι έχουμε δύο σήματα, \( m_1(t) \) και \( m_2(t) \), καθώς και το γνωστό φέρον
\( c(t) = A_c\cos2πf_c t \). Διαμορφώνουμε τα σήματα κατά \hyperref[dsbsc.demodulator]{DSB-SC}, όπως
παρουσιάσαμε στην προηγούμενη ενότητα. Το ένα το διαμορφώνουμε
με φέρον \( A_c\cos 2π f_c t \), και το άλλο με φέρον
\( A_c\sin 2πf_c t \), δηλαδή φάση μικρότερη κατά \( 90\degree \).
Στο τέλος, προσθέτουμε τα δύο διαμορφωμένα σήματα:

\begin{circuitikz}[scale=1.2]
	\draw (0,-0.75) node[draw,rectangle] (ps) {$-90\degree$};
	\draw (0,2) node[draw,rectangle,scale=2,outer sep=0] (m1) {$\times$};
	\draw (0,-2) node[draw,rectangle,scale=2, outer sep=0] (m2) {$\times$};
	\draw (2,0) node[oscillator,xshift=4.9mm] (osc) {};
	\draw (3,2) node[draw,circle,scale=1.2,thick] (sum) {$\sum$};
	
	\draw[->] (osc.west) -| (m1);
	\draw[->] (osc.west) -| (ps) -- (m2);
	\draw[->] (m1) -- (sum) node[above,midway] {$s(t)$};
	\draw[->] (m2) -| (sum);
	\draw[->] (sum) -- ++(2,0) node[above right,pos=.2]
	{$s(t)=A_cm(t)\cos 2πf_c t + A_cm(t)\sin2πf_ct$};
	\draw[<-] (m1) -- ++(-2,0) node[above,midway] {$m_1(t)$};
	\draw[<-] (m2) -- ++(-2,0) node[below,midway] {$m_2(t)$};
	
	\path (m2) -- (m2 -| sum) node[pos=0,below right] {$s'(t) = A_cm(t)\sin2πf_ct$};
	\path (osc -| ps) -- (m1.south) node[midway,right,scale=.8] {$\cos(2πf_ct+\phi)$};
	\path (ps.south) -- (m2.north) node[midway,right,scale=.8] {$\sin(2πf_ct+\phi)$};
	
	\draw (m1.north) node[above,blue!50!black,scale=1.2] (I) {I};
	\draw (I) node[above,blue!50!black,scale=.7,yshift=2mm] {in phase};
	\draw (m2.south) node[below,blue!50!black,scale=1.2] (Q) {Q};
	\draw (Q) node[below,blue!50!black,scale=.7,yshift=-2mm] {quadrature};
	
	\draw[<-,green!50!gray] (m1.north east) to[bend left] ++(0.7,0.5)
	node[right,scale=.9] {διαμορφωτής (πολλαπλασιασμού)};
\end{circuitikz}

Δηλαδή η έξοδος είναι:
\[
s(t) = A_c m(t)\cos 2π  f_c t
+ A_c m(t) \sin 2π f_c t
\]

Για να τη μελετήσουμε στο πεδίο της συχνότητας, πρώτα θυμόμαστε τους
Μ/Σ Fourier των \( \cos \) και \( \sin \):
\begin{align*}
	\cos 2πf_c t &\leftrightarrow
	\frac{1}{2} δ(f-f_c) + \frac{1}{2}δ(f-f_c)
	\\
	\sin 2πf_ct &\leftrightarrow
	\frac{1}{2} jδ(f-f_c) + \frac{1}{2}jδ(f+f_c)
\end{align*}

Δηλαδή το πεδίο της συχνότητας περιέχει τιμές στο μιγαδικό επίπεδο,
οι οποίες μπορούν να παρουσιαστούν ως εξής:

\begin{tikzpicture}[scale=1]
\draw[brown!50!orange!50!blue,ultra thick,->]
(2,0) node[below,black,xshift=1mm] {$f_c$} -- ++(0,1.4) node[right] {$\cos t$};
\draw[brown!30!orange!30!blue,ultra thick,->]
(2,0) -- ++(0,0,2.5) node[below right] {$\sin t$};

\draw[brown!50!orange!50!blue,ultra thick,->]
(-2,0) node[below,black,xshift=2mm] {$-f_c$} -- ++(0,1.4);
\draw[brown!30!orange!30!blue,ultra thick,->]
(-2,0) -- ++(0,0,2.5);

\draw[->] (-4,0) -- (4,0) node[right] {$f$};
\draw[->] (0,-2) -- (0,2.5) node[right] {Re};
\draw[->] (0,0,0) -- (0,0,5) node[below right] {Im};
\draw[path fading=east] (0,0,0) -- (0,0,-5);
\end{tikzpicture}

Άρα το σήμα έχει μορφή:

\begin{tikzpicture}[scale=1]
\draw[draw=orange!50!brown,very thick]
(-0.8,0) node[below] {$-w$}
-- (0,1.4)
-- (0.8,0) node[below] {$w$}
;

\draw (-2,0) -- (2,0);
\draw (0,-2.5) -- (0,2.5) node[right] {$M(f)$};

\draw[->,very thick, black]
(2.5,0) -- ++(2,0);

\begin{scope}[xshift=9cm]
\draw[opacity=.5,dashed] (-2,0) -- ++(0,1.4);
\draw[opacity=.5,dashed] (2,0) -- ++(0,1.4);

\draw[orange!50!black,opacity=.5] (2-1,0) |- (2,0.6) -| node[above right,scale=.8] {$2w$} (2+1,0);

\draw[xshift=-2cm,draw=brown!50!orange,very thick,every node/.style={scale=.9}]
(-0.8,0) -- (0,1.4) -- (0.8,0)
(0,0) node[below] {$-f_c$};

\draw[xshift=-2cm,draw=brown!50!orange,very thick,fill=red,fill opacity=.1,postaction={pattern=north east lines,opacity=.3}]
(-0.8,0,0) -- (0,0,3) -- (0.8,0,0);
\draw[xshift=2cm,draw=brown!50!orange,very thick,fill=red,fill opacity=.1,postaction={pattern=north east lines,opacity=.3}]
(-0.8,0,0) -- (0,0,3) -- (0.8,0,0);

\draw[xshift=2cm,draw=brown!50!orange,very thick]
(-0.8,0) node[below,scale=.7] {$f_c-w$}
-- (0,1.4)
-- (0.8,0) node[below,scale=.7] {$f_c+w$}
(0,0) node[below] {$f_c$}
;

\draw (-4,0) -- (4,0);
\draw[->] (0,-1.5) -- (0,2.5) node[right] {Re};
\draw[->] (0,0,0) -- (0,0,5) node[below right] {Im};
\end{scope}
\end{tikzpicture}

Να σημειωθεί πως το γεγονός ότι υπάρχουν και τιμές στον φανταστικό
άξονα, δεν σημαίνει ότι το σήμα δεν υφίσταται στην πραγματικότητα,
αλλά ότι περιέχει και δεδομένα στην φάση του!

Η διαδικασία της αποδιαμόρφωσης μπορεί να μας επιστρέψει και τα
δύο σήματα, όπως και στον αποδιαμορφωτή DSB-SC, πολλαπλασιάζοντας
την είσοδο αρχικά με \( \cos2π f_c t \), και μετά με \( \sin 2π f_c t \):

\begin{circuitikz}[scale=1.2,yscale=0.7]
	\draw (0,-0.75) node[draw,rectangle] (ps) {$-90\degree$};
	\draw (0,2) node[draw,rectangle,scale=2,outer sep=0] (m1) {$\times$};
	\draw (0,-2) node[draw,rectangle,scale=2, outer sep=0] (m2) {$\times$};
	\draw (2,0) node[oscillator,xshift=4.9mm] (osc) {};
	\draw (2,2) node[draw,rectangle,inner sep=5pt] (lpf1) {LPF};
	\draw (2,-2) node[draw,rectangle,inner sep=5pt] (lpf2) {LPF};
	
	\coordinate (M) at (-1.5,0);
	
	\draw[<-] (M) -- ++(-1,0) node[midway,above] {$s(t)$};
	\draw[->] (M) |- (m1.west);
	\draw[->] (M) |- (m2.west);
	\draw[->] (osc.west) -| (m1);
	\draw[->] (osc.west) -| (ps) -- (m2);
	\draw[->] (m1) -- (lpf1);
	\draw[->] (m2) -- (lpf2);
	\draw[->] (lpf1) -- ++(2,0) node[above] {$A_c m_1(t)$};
	\draw[->] (lpf2) -- ++(2,0) node[below] {$A_c m_2(t)$};
	
	\path (ps.south) -- (m2.north) node[midway,right,scale=.7] {$\sin(2πf_ct)$};
\end{circuitikz}

Οπότε, π.χ η πρώτη έξοδος είναι:
\begin{align*}
	s(t) \cos 2π f_c t
	&= 2 A_c m_1(t) \cos^2 2π f_c t + 2A_c m_2(t)\cos2π f_c t
	\sin2πf_c t \\
	&= A_c m_1(t)
\end{align*}

Αυτή η τεχνική εκμεταλλεύεται την ορθογωνικότητα του ημιτόνου και του
συνημιτόνου ώστε να μεταδώσει διπλάσιο σήμα στο ίδιο εύρος ζώνης.
Είναι μία τεχνική \textbf{πολυπλεξίας}, και ονομάζεται
\textbf{QAM (Quadrature Amplitude Modulation - Διαμόρφωση ορθογωνικών
	φερόντων)}. Δεν χρησιμοποιούνταν σε εμπορικές εφαρμογές λόγω
του κόστους των πολλών διαμορφωτών και του κυκλώματος συγχρονισμού.

\subsection{SSB}
Αφού τα αρχικά σήματα που χρησιμοποιούμε έχουν δίπλευρο φάσμα, όταν
διαμορφωθούν, ξοδεύουν εύρος ζώνης \( 2w \), και το σήμα εμφανίζεται
δύο φορές γύρω από τη συχνότητα \( f_c \).

\begin{tikzpicture}[scale=1]
\draw[draw=orange!50!brown,very thick]
(-0.8,0) node[below] {$-w$}
-- (0,1.4)
-- (0.8,0) node[below] {$w$}
;

\draw (-2,0) -- (2,0);
\draw (0,-0.5) -- (0,2.5);

\draw[->,very thick, black]
(2.5,1) -- ++(2,0);

\begin{scope}[xshift=9cm]
\fill[opacity=.5,path fading=east,green!30!gray] (2,0) -- ++(0,1.6) -- ++(25:1.5) -- ++(0,-3.1) -- (2,-0.2);

\draw[opacity=.5] (2,0) -- ++(0,1.6) edge[path fading=north] ++(25:1.5)
(2,0) -- ++(0,-0.2) edge[path fading=south] ++(-25:1.5);


\draw[opacity=.5,dashed] (-2,0) -- ++(0,1.4);
\draw[opacity=.5,dashed] (2,0) -- ++(0,1.4);

\draw[orange!50!black,opacity=.8] (2-1,0) |- (2,-0.6) -| node[below right,scale=.8] {$2w$} (2+1,0);
\draw[orange!70!black,opacity=.8] (2,0) |- (2,-0.3) -| (2+0.8,0) node[midway,below,scale=.7] {$w$};

\draw[xshift=-2cm,draw=brown!50!orange,very thick,every node/.style={scale=.9}]
(-0.8,0) -- (0,1.4) -- (0.8,0)
(0,0);

\draw[xshift=2cm,draw=brown!50!orange,very thick]
(-0.8,0)
-- (0,1.4)
-- (0.8,0)
(0,0) node[above right] {$f_c$}
;

\draw (-4,0) -- (4,0);
\draw[->] (0,-0.5) -- (0,2.5);
\end{scope}
\end{tikzpicture}

Αν μπορούσαμε να "κόψουμε" το ένα (π.χ. το αριστερό) κομμάτι του
διαμορφωμένου σήματος, θα είχαμε την ίδια πληροφορία, αλλά θα
καταναλώναμε μισό εύρος ζώνης. Για αυτό παρουσιάζουμε παρακάτω
τη διαμόρφωση \textbf{SSB (Single Side Band)}.

Η διαμόρφωση αυτή λειτουργεί καλύτερα σε ακουστικά και όχι
οπτικά/σήματα δεδομένων, επειδή τα ακουστικά σήματα ξεκινούν από
συχνότητες 20-600 Hz, και δεν έχουν DC κομμάτι:

\begin{tikzpicture}[scale=1.2]
\draw (-3,0) -- (3,0);
\draw[->] (0,-1.5) -- (0,2.5);

\def\s{1.4}

\begin{scope}
\clip (-3,0) rectangle (3,2); % clip below 0

\draw[xshift=-\s cm,draw=brown!70!orange,very thick] plot[smooth]
coordinates {(-0.8,0) (-0.5,0.2) (0,1.4) (0.5,0.2) (0.8,0)}
;

\draw[xshift=\s cm,draw=brown!70!orange,very thick] plot[smooth]
coordinates {(-0.8,0) (-0.5,0.2) (0,1.4) (0.5,0.2) (0.8,0)}
;
\end{scope}

\draw (-0.8+\s,0) node[below] {$f_a$};
\draw (0.8+\s,0) node[below] {$f_b$};
\draw (0.8-\s,0) node[below] {$-f_a$};
\draw (-0.8-\s,0) node[below] {$-f_b$};

\draw[dashed,opacity=.5,path fading=north] (\s-0.8,0) -- ++(0,2);
\draw[dashed,opacity=.5,path fading=north] (-\s+0.8,0) -- ++(0,2);

\draw (current bounding box.east) node[right] {ακουστικό σήμα};
\end{tikzpicture}

\pagebreak[4]
Αρχικά, διαμορφώνουμε το σήμα κατά τα γνωστά, με
\hyperref[dsb-sc]{DSB-SC}:\\*%
\begin{tikzpicture}[scale=1]
\draw (-7,0) -- (7,0);
\draw[->] (0,-1.5) -- (0,2.5) node[right] {DSB-SC};

\def\s{3.5}
\def\four{(-0.6,0) (-0.4,0.2) (0,1) (0.4,0.2) (0.6,0)}

\begin{scope}
\clip (-6,0) rectangle (6,2); % clip below 0

\draw[xshift=-\s cm,draw=brown!70!orange,very thick] plot[smooth]
coordinates \four
;
\draw[xshift=-\s cm-1.6 cm,draw=brown!70!orange,very thick] plot[smooth]
coordinates \four
;

\draw[xshift=\s cm,draw=brown!70!orange,very thick] plot[smooth]
coordinates \four
;
\draw[xshift=\s cm+1.6 cm,draw=brown!70!orange,very thick] plot[smooth]
coordinates \four
;
\end{scope}

\draw (\s+0.8,0) node[below] {$f_c$};
\draw (-\s-0.8,0) node[below] {$-f_c$};
\end{tikzpicture}

και χρησιμοποιούμε ένα Band Pass φίλτρο για να πάρουμε μόνο το δεξί
μέρος του διαμορφωμένου φάσματος. Το γεγονός ότι χρησιμοποιούμε
το δεξί κομμάτι οφείλεται στην ονομασία
\textbf{USB (Upper Side Band)} της διαδικασίας
(δεν έχει σχέση με το USB του υπολογιστή!):

\begin{tikzpicture}[scale=1]
\filldraw[fill=blue!40!cyan!80!black,fill opacity=.3]
(5-0.6,0) -- ++(0.1,1.2) -- ++(1.2,0) -- ++(0.1,-1.2);
\filldraw[fill=blue!40!cyan!80!black,fill opacity=.3,xscale=-1]
(5-0.6,0) -- ++(0.1,1.2) -- ++(1.2,0) -- ++(0.1,-1.2);

\draw (-7,0) -- (7,0);
\draw[->] (0,-1.5) -- (0,2.5) node[right] {DSB-SC};

\def\s{3.5}
\def\four{(-0.6,0) (-0.4,0.2) (0,1) (0.4,0.2) (0.6,0)}

\begin{scope}
\clip (-6,0) rectangle (6,2); % clip below 0

\draw[xshift=-\s cm,draw=brown!70!orange,very thick] plot[smooth]
coordinates \four
;
\draw[xshift=-\s cm-1.6 cm,draw=brown!70!orange,very thick] plot[smooth]
coordinates \four
;

\draw[xshift=\s cm,draw=brown!70!orange,very thick] plot[smooth]
coordinates \four
;
\draw[xshift=\s cm+1.6 cm,draw=brown!70!orange,very thick] plot[smooth]
coordinates \four
;
\end{scope}

\draw (\s+0.8,0) node[below] {$f_c$};
\draw (-\s-0.8,0) node[below] {$-f_c$};

\begin{scope}[yshift=-5cm]
\draw (-7,0) -- (7,0);
\draw[->] (0,-1.5) -- (0,2.5);

\begin{scope}
\clip (-6,0) rectangle (6,2); % clip below 0

\draw[xshift=-\s cm-1.6 cm,draw=brown!70!orange,very thick] plot[smooth]
coordinates \four
;

\draw[xshift=\s cm+1.6 cm,draw=brown!70!orange,very thick] plot[smooth]
coordinates \four
;
\end{scope}

\draw (\s+0.8,0) node[below] {$f_c$};
\draw (-\s-0.8,0) node[below] {$-f_c$};
\end{scope}
\end{tikzpicture}

Έτσι πήραμε το τελικό διαμορφωμένο σήμα. Για την αποδιαμόρφωση,
πολλαπλασιάζουμε ως γνωστόν με το φέρον \( \cos 2πf_c t \), και
παίρνουμε γραφικά τις συνελίξεις:

\begin{tikzpicture}[scale=1]
\filldraw[fill=blue!40!cyan!80!black,fill opacity=.15]
(-1.6,0) -- ++(0.1,1.2) -- ++(3,0) -- ++(0.1,-1.2);

\draw (-7,0) -- (7,0);
\draw[->] (0,-1) -- (0,2.5);

\def\s{2.5}
\def\four{(-0.6,0) (-0.4,0.2) (0,1) (0.4,0.2) (0.6,0)}

\begin{scope}
\clip (-6,0) rectangle (6,2); % clip below 0

\draw[xshift=-0.8 cm,draw=brown!70!orange,very thick] plot[smooth]
coordinates \four
;
\draw[xshift=0.8 cm,draw=brown!70!orange,very thick] plot[smooth]
coordinates \four
;

\draw[xshift=-2*\s cm,draw=brown!50!orange!80!cyan,very thick] plot[smooth]
coordinates \four
;

\draw[xshift=2*\s cm,draw=brown!50!orange!80!cyan,very thick] plot[smooth]
coordinates \four
;
\end{scope}

\draw[ultra thick,->] (\s+0.4,0) node[below] {$f_c$} node[circle,fill,inner sep=2pt] {} -- ++(0,1.5);
\draw[ultra thick,->] (-\s-0.4,0) node[below] {$-f_c$} node[circle,fill,inner sep=2pt] {} -- ++(0,1.5);
\end{tikzpicture}

που με ένα απλό Low Pass Filter μάς δίνουν το αρχικό ακουστικό σήμα.

\vbox{
	Αν και παραστήσαμε αυτές τις αλλαγές στο πεδίο της συχνότητας, τώρα
	πρέπει να τις υλοποιήσουμε. Η δυσκολία της υλοποίησης έγκειται στο
	ότι το φίλτρο που αποκόπτει το επάνω μέρος πρέπει να έχει πολύ
	μικρή ζώνη μετάβασης. Αν μελετήσουμε την τυπική απόκριση συχνότητας 
	ενός band pass filter:

	\begin{tikzpicture}[scale=1.9]
	\draw[->] (0,-0.5) -- (0,2);
	\draw[->] (-0.5,0) -- (6,0);
	
	\def\four{(-0.6,0) (-0.4,0.2) (0,1) (0.4,0.2) (0.6,0)}
	
	\begin{scope}
	\clip (0,0) rectangle (6,2); % clip below 0
	
	\draw[xshift=2 cm,draw=brown!70!orange,very thick] plot[smooth]
	coordinates \four;
	\draw[xshift=4 cm,draw=brown!70!orange,very thick] plot[smooth]
	coordinates \four;
	\end{scope}
	
	\draw[dashed] (2+0.6,-0.1) node[below,xshift=-3mm,scale=.9] {$f_c-f_a$} -- ++(0,3);
	\draw[dashed,opacity=.5] (3,-0.1) -- ++(0,0.3);
	\draw (3,-0.1) node[below] {$f_c$};
	\draw[dashed] (4-0.6,-0.1) node[below,xshift=3mm,scale=.9] {$f_c+f_a$} -- ++(0,3);
	
	\draw[very thick,blue!50!cyan]
	(1,0) -- plot[smooth,tension=0.5]
	coordinates {(2+0.6,0) (2+0.6+0.3,0.2) (4-0.6,1.2) (4,1.34) (4+0.6,1.2) ({-0.3+4+0.6+(4-0.6)-(2+0.6))},0.2) ({4+0.6+(4-0.6)-(2+0.6))},0)}
	-- (5.9,0)
	(4,1.3) node[above,scale=.9] {BPF};
	;
	
	\draw[<->] (2+0.6,2) -- (4-0.6,2) node[above,midway,scale=.9] {600 Hz};
	\draw (3,2.5) node[above,scale=.77,green!40!black,align=center] {ζώνη\\μετάβασης};
	\end{tikzpicture}
}


Βλέπουμε ότι η ζώνη μετάβασης είναι αρκετά στενή, και η υλοποίηση
ενός τέτοιου φίλτρου γίνεται όλο και δυσκολότερη όσο αυξάνεται
η συχνότητα \( f_c \). Να σημειωθεί ότι το πλάτος της ζώνης μετάβασης
χαρακτηρίζεται από τη σχέση \( \frac{2f_a}{f_c} \), η οποία
έχει τιμή 5\% για απλά αναλογικά κυκλωματικά φίλτρα.

Για παράδειγμα, αν ο ήχος μας ξεκινάει από 300 Hz και θέλουμε να
μεταδώσουμε σε μια συχνότητα 1 Mhz, τότε η ζώνη μετάβασης έχει
πλάτος \( \frac{2\cdot 300}{10^6}
= 6\cdot10^{-4} = 0.06\% \), που είναι κάτι πολύ μικρό για τις δυνατότητες των φίλτρων.

\subsubsection{Μία τεχνική αποκοπής συχνότητας}

Για να λύσουμε το παραπάνω πρόβλημα, σκεφτόμαστε αν μπορούμε να
μετακινήσουμε ελαφρά το σήμα μας στη συχνότητα, ουσιαστικά
αυξάνοντας τη συχνότητα \( f_a \). Πράγματι, αυτό μπορεί να γίνει
εφαρμόζοντας την προηγούμενη διαδικασία (διαμόρφωση DSB-SC + BPF),
αλλά αυξάνοντας τη
συχνότητα μόνο κατά κάποια μικρή τιμή, π.χ. 10 kHz, και όχι αμέσως
1 Mhz:

\begin{tikzpicture}[scale=.7]
\def\bw{0.6}
\def\A{1}

\def\fa{3+\bw}
\def\fb{5.8}
\def\tz{0.2}

\draw[dashed,brown] (3+\bw,0) -- ++(0,3);
\draw[dashed,brown] (4.6-\bw,0) -- ++(0,3);
\draw[brown,<->] (3+\bw,2.5) -- (4.6-\bw,2.5)
node[right,brown!60!black,scale=.7] {600 Hz};

\filldraw[fill=blue!40!cyan!80!black,fill opacity=.15] plot[smooth,tension=0.1] coordinates {
	(\fa,0) (\fa+\tz,1.2) (\fb-\tz,1.2) (\fb,0)
};
\draw ({(\fa+\fb)/2},1.2) node[above,scale=.9,yshift=1mm] {BPF1};

\draw[->] (-6,0) -- (6,0) node[below] {$f$};
\draw (0,-1) -- (0,3);

\def\spectrum{plot[smooth,tension=1] coordinates {(-\bw,0) (0,\A) (+\bw,0)}}

\draw[very thick,blue!50!cyan,xshift=-4.6cm] \spectrum;
\draw[very thick,blue!50!cyan,xshift=-3cm] \spectrum;

\draw[very thick,blue!50!cyan,xshift=3cm] \spectrum;
\draw[very thick,blue!50!cyan,xshift=4.6cm] \spectrum;

\draw (3.8,0) node[below,scale=.9] {10 kHz} ++ (45+90:0.1) -- ++(-45:0.2);

\draw[very thick, brown!50!gray!20!black,>->] (6.5,0.5) -- ++(1,0);

\begin{scope}[xshift=12cm]
\draw[->] (-4,0) -- (4,0) node[below] {$f$};
\draw (0,-1) -- (0,3) node[right] {(1)};

\draw[very thick,blue!50!cyan,xshift=-3cm] \spectrum;
\draw[very thick,blue!50!cyan,xshift=3cm] \spectrum;

\draw (-2.25,0) node[below,scale=.8] {-10 kHz} ++ (90+45:0.1) -- ++(-45:0.2);
\draw (2.25,0) node[below,scale=.8] {10 kHz} ++ (45+90:0.1) -- ++(-45:0.2);
\end{scope}
\end{tikzpicture}

Πράγματι, το νέο αυτό φίλτρο έχει ζώνη μετάβασης \(
 \frac{2\cdot300}{10k} = 6\% \) που είναι όντως υλοποιήσιμο!

Συνεχίζουμε την ίδια διαδικασία, διαμορφώνοντας και 
μετακινώντας το σήμα μας αυτήν τη
φορά από τα 10 kHz μέχρι τα 100 kHz:

\begin{tikzpicture}[scale=.7]
\def\bw{0.55}
\def\A{1}

\def\fa{3+\bw}
\def\fb{5.8}
\def\tz{0.2}

\draw[dashed,brown] (3+\bw,0) -- ++(0,3);
\draw[dashed,brown] (4.6-\bw,0) -- ++(0,3);
\draw[brown,<->] (3+\bw,2.5) -- (4.6-\bw,2.5)
node[right,brown!60!black,scale=.7] {$2\cdot10300$ Hz};

\filldraw[fill=blue!60!cyan!80!black,fill opacity=.15] plot[smooth,tension=0.1] coordinates {
	(\fa,0) (\fa+\tz,1.2) (\fb-\tz,1.2) (\fb,0)
};
\draw ({(\fa+\fb)/2},1.2) node[above,scale=.9,yshift=1mm] {BPF2};

\draw[->] (-6,0) -- (6,0) node[below] {$f$};
\draw (0,-1) -- (0,3);

\def\spectrum{plot[smooth,tension=1] coordinates {(-\bw,0) (0,\A) (+\bw,0)}}

\draw[very thick,blue!70!cyan,xshift=-4.6cm] \spectrum;
\draw[very thick,blue!70!cyan,xshift=-3cm] \spectrum;

\draw[very thick,blue!70!cyan,xshift=3cm] \spectrum;
\draw[very thick,blue!70!cyan,xshift=4.6cm] \spectrum;

\draw (3.8,0) node[below,scale=.9] {100 kHz} ++ (45+90:0.1) -- ++(-45:0.2);

\draw[very thick, brown!50!gray!20!black,>->] (6.5,0.5) -- ++(1,0);

\begin{scope}[xshift=12cm]
\draw[->] (-4,0) -- (4,0) node[below] {$f$};
\draw (0,-1) -- (0,3) node[right] {(2)};

\draw[very thick,blue!70!cyan,xshift=-3cm] \spectrum;
\draw[very thick,blue!70!cyan,xshift=3cm] \spectrum;

\draw (2.3,0) node[below,scale=.8] {100 kHz} ++ (45+90:0.1) -- ++(-45:0.2);
\end{scope}
\end{tikzpicture}

Με ζώνη μετάβασης \( \frac{2\cdot 10600}{100\cdot 10^3} 
= 21.2 \% \), που είναι απόλυτα υλοποιήσιμη.

Και ξανά για 100 kHz σε 1 Mhz:

\begin{tikzpicture}[scale=.7]
\def\bw{0.55}
\def\A{1}

\def\fa{3+\bw}
\def\fb{5.8}
\def\tz{0.2}

\draw[dashed,brown] (3+\bw,0) -- ++(0,3);
\draw[dashed,brown] (4.6-\bw,0) -- ++(0,3);
\draw[brown,<->] (3+\bw,2.5) -- (4.6-\bw,2.5)
node[right,brown!60!black,scale=.7] {$2\cdot110300$ Hz};

\filldraw[fill=blue!80!cyan!80!black,fill opacity=.15] plot[smooth,tension=0.1] coordinates {
	(\fa,0) (\fa+\tz,1.2) (\fb-\tz,1.2) (\fb,0)
};
\draw ({(\fa+\fb)/2},1.2) node[above,scale=.9,yshift=1mm] {BPF3};

\draw[->] (-6,0) -- (6,0) node[below] {$f$};
\draw (0,-1) -- (0,3);

\def\spectrum{plot[smooth,tension=1] coordinates {(-\bw,0) (0,\A) (+\bw,0)}}

\draw[very thick,blue!90!cyan,xshift=-4.6cm] \spectrum;
\draw[very thick,blue!90!cyan,xshift=-3cm] \spectrum;

\draw[very thick,blue!90!cyan,xshift=3cm] \spectrum;
\draw[very thick,blue!90!cyan,xshift=4.6cm] \spectrum;

\draw (3.8,0) node[below,scale=.9] {1000 kHz} ++ (45+90:0.1) -- ++(-45:0.2);

\draw[very thick, brown!50!gray!20!black,>->] (6.5,0.5) -- ++(1,0);

\begin{scope}[xshift=12cm]
\draw[->] (-4,0) -- (4,0) node[below] {$f$};
\draw (0,-1) -- (0,3) node[right] {(3)};

\draw[very thick,blue!90!cyan,xshift=-3cm] \spectrum;
\draw[very thick,blue!90!cyan,xshift=3cm] \spectrum;

\draw (-2.25,0) node[below,scale=.8] {-1 MHz} ++ (90+45:0.1) -- ++(-45:0.2);
\draw (2.25,0) node[below,scale=.8] {1 MHz} ++ (45+90:0.1) -- ++(-45:0.2);
\end{scope}
\end{tikzpicture}

Με ζώνη μετάβασης \( \frac{2\cdot 110600}{10^6} 
= 22.12\%\), που είναι και αυτό υλοποιήσιμο φίλτρο, και έχουμε φτάσει
στο ζητούμενο, διαμορφωμένο κατά USB, σήμα.

Συνοπτικά, το κύκλωμα αποτελείται από μια σειρά
πολλαπλαστικών διαμορφωτών και φίλτρων:

\begin{circuitikz}
	\draw (1,0) node[rectangle,draw,minimum width=8mm,minimum height=8mm] (mult1) {}
	node[scale=1.5] {$\times$};
	\draw (3,0) node[rectangle,draw,minimum width=15mm,minimum height=10mm] (bpf1) {}
	node[scale=1] {BPF\textsubscript{1}};
	\draw (6.5,0) node[rectangle,draw,minimum width=8mm,minimum height=8mm] (mult2) {}
	node[scale=1.5] {$\times$};
	\draw (8.5,0) node[rectangle,draw,minimum width=15mm,minimum height=10mm] (bpf2) {}
	node[scale=1] {BPF\textsubscript{2}};
	\draw (12,0) node[rectangle,draw,minimum width=8mm,minimum height=8mm] (mult3) {}
	node[scale=1.5] {$\times$};
	\draw (14,0) node[rectangle,draw,minimum width=15mm,minimum height=10mm] (bpf3) {}
	node[scale=1] {BPF\textsubscript{3}};
	
	\draw (mult1) ++(0,-2) node[xshift=4.9mm,oscillator] (osc1) {} node[right,xshift=4.9mm] {10 kHz};
	\draw (mult2) ++(0,-2) node[xshift=4.9mm,oscillator] (osc2) {} node[right,xshift=4.9mm] {100 kHz};
	\draw (mult3) ++(0,-2) node[xshift=4.9mm,oscillator] (osc3) {} node[right,xshift=4.9mm] {1 MHz};
	
	\draw[<-] (mult1) -- ++(-2,0) node[above,midway] {$m(t)$};
	\draw[->] (osc1.north) -- (mult1);
	\draw[->] (osc2.north) -- (mult2);
	\draw[->] (osc3.north) -- (mult3);
	\draw[->] (mult1) -- (bpf1);
	\draw[->] (bpf1.east) node[above right] {(1)} -- (mult2);
	\draw[->] (mult2) -- (bpf2);
	\draw[->] (bpf2.east) node[above right] {(2)} -- (mult3);
	\draw[->] (mult3) -- (bpf3);
	\draw[->] (bpf3.east) -- ++ (1,0);
\end{circuitikz}

Και, αν θέλουμε, μειώνουμε τη συχνότητα του τελευταίου ταλαντωτή
ώστε το σήμα να πέσει ακριβώς επάνω στην \( f_c \) του φέροντος.

\subsubsection{Μελέτη στο πεδίο του χρόνου}
Ας μελετήσουμε και τις χρονικές εξισώσεις του LSB.

Για ευκολία, θεωρούμε ότι το σήμα μας είναι ένα ημίτονο:
\[
m(t) = A_m \cos 2π f_m(t) % ωχ! ένα συνημίτονο αντί για ημίτονο!
\]
και έχουμε και το φέρον:
\[
A_c\cos 2πf_c t
\]
με \( f_c\gg f_m \).

Από τη διαμόρφωση \hyperref[dsb-sc]{DSB-SC} θυμόμαστε ότι η έξοδος του διαμορφωτή είναι
το σήμα πολλαπλασιασμένο με το φέρον:
\[
s_{\mathrm{DSB-SC}} = \frac{1}{2}
A_cA_m\cos\left[ 2π(f_c+f_m)t \right] + \frac{1}{2}A_cA_m\cos[2π(f_c-f_m)t]
\]

\begin{tikzpicture}[scale=1]
\draw (-6,0) -- (6,0);
\draw (0,-1) -- (0,3);

\def\a{1.4}

\def\fa{-4}
\def\fb{4}
\def\tz{0.2}
\filldraw[fill=blue!80!cyan!80!black,fill opacity=.12]
(\fa,0) -- (\fa+\tz,1.8) -- (\fb-\tz,1.8) node[above left,opacity=1] {LSB} -- (\fb,0);
\def\fa{4}
\def\fb{\fa+2}
\filldraw[fill=brown!80!orange!80!black,fill opacity=.25,path fading=east]
(\fa,0) -- (\fa+\tz,1.8) -- ++(2,0) -- ++(0,-1.8);
\draw (\fa+\tz,1.8) node[above right,opacity=1] {USB};
\filldraw[fill=brown!80!orange!80!black,fill opacity=.25,xscale=-1,path fading=west]
(\fa,0) -- (\fa+\tz,1.8) -- ++(2,0) -- ++(0,-1.8);


\draw[->,ultra thick,blue!80!brown] (-5,0) node[below] {$-f_c-f_m$} -- ++(0,\a);
\draw[->,ultra thick,blue!80!brown] (-3,0) node[below] {$-f_c+f_m$} -- ++(0,\a);
\draw[->,ultra thick,blue!80!brown] (3,0) node[below] {$-f_c-f_m$} -- ++(0,\a);
\draw[->,ultra thick,blue!80!brown] (5,0) node[below] {$-f_c+f_m$} -- ++(0,\a);

\draw[dashed] (-6,\a) -- (6,\a) node[midway,below right,scale=.8] {$\sfrac{1}{2}A_cA_m$};
\end{tikzpicture}

και για να εφαρμόσουμε USB παίρνουμε ένα υψιπερατό/ζωνοπερατό φίλτρο,
όπως φαίνεται στο διάγραμμα:
\begin{align*}
	s_{\mathrm{USSB}}(t) &= \frac{1}{2} A_cA_m\cos[2π(f_c+f_m)t]
	\\ &= \frac{1}{2}A_cA_m\cos 2πf_ct - \frac{1}{2}A_cA_m\sin2πf_ct \sin 2πf_m t
\end{align*}
και αντίστοιχα για LSB, παίρνουμε ένα χαμηλοπερατό φίλτρο για την κάτω πλευρική ζώνη:
\[
s_{\mathrm{LSSB}} =
\frac{1}{2}A_cA_m\cos 2πf_ct + \frac{1}{2}A_cA_m\sin2πf_ct \sin 2πf_m t
\]

Επομένως, μπορούμε να κατασκευάσουμε έναν διαμορφωτή, ο οποίος αφαιρεί ουσιαστικά την
κάτω πλευρική ζώνη, με βάση τους παραπάνω τύπους:

\begin{circuitikz}[scale=1]
	\draw (0,-0.75) node[draw,rectangle] (ps1) {$-90\degree$};
	\draw (0,2) node[draw,rectangle,scale=2,outer sep=0] (m1) {$\times$};
	\draw (0,-2) node[draw,rectangle,scale=2, outer sep=0] (m2) {$\times$};
	\draw (2,0) node[oscillator,xshift=4.9mm] (osc) {};
	\draw (4,0) node[draw,circle,scale=1.2,thick] (sum) {$\sum$};
	
	\draw[->] (osc.west) -| (m1);
	\draw[->] (osc.west) -| (ps1) -- (m2);
	\draw[->] (m1) -| node[above right] {(1)} (sum);
	\draw[->] (m2) -| node[below right] {(2)} (sum.south) node[yshift=-2mm,right] {$\pm$};
	\draw[->] (sum) -- ++(1.5,0) node[right]
	{$s_{\mathrm{USSB}}(t)\Big/s_{\mathrm{LSSB}}(t)$};
	\draw[<-] (m1) -- ++(-5,0) node[above,midway] {$m(t)=A\cos2πf_m(t)$} node[pos=.5] (p) {};
	\draw (p |- 0,-2) node[draw,rectangle] (ps2) {$-90\degree$};
	\draw[->] (p.center) node[circ] {} -- (ps2) |- (m2);
	
	\path (ps1.south) -- (m2.north) node[midway,right,scale=.8] {$\sfrac{1}{2}A_c\sin2πf_ct$};
\end{circuitikz}

Αυτός ο υπολογισμός πραγματοποιήθηκε για έναν απλό τόνο. Ας τον εφαρμόσουμε ξανά για μια
περιοδική κυματομορφή (δηλαδή ένα άθροισμα ημιτόνων):
\[
m(t) = \sum_{n} a_n \cos(2πfnt)
\]

και τότε θα προκύψει π.χ.
\[
s_{\mathrm{USSB}}(t)
= \frac{1}{2} A_cA_m \cos 2π f_c t + \sum_n a_n\cos(2πfnt)
-\frac{1}{2}A_cA_m \sin 2πf_ct\sum_n a_n\sin(2πfnt)
\]
και το κύκλωμα διαμόρφωσης θα λειτουργεί ακριβώς με τον ίδιο τρόπο. Ακόμα και η περιστροφή
φάσης κατά \( 90\degree \), είναι ουσιαστικά ένα κύκλωμα καθυστέρησης στο χρόνο, που
ονομάζεται \textit{μετατροπέας φάσης (phase shifter)}.

Στη γενική περίπτωση, ορίζουμε ως \textbf{μετασχηματισμό Hilbert} τη στροφή της φάσης του
σήματός μας κατά \( 90\degree \), που μπορεί να πραγματοποιηθεί ακόμα και για μη περιοδικά
σήματα.

\begin{circuitikz}[scale=0.7,every node/.style={scale=.7}]
	\draw (0,-0.75) node[draw,rectangle] (ps1) {$-90\degree$};
	\draw (0,2) node[draw,rectangle,scale=2,outer sep=0] (m1) {$\times$};
	\draw (0,-2) node[draw,rectangle,scale=2, outer sep=0] (m2) {$\times$};
	\draw (2,0) node[oscillator,xshift=4.9mm] (osc) {};
	\draw (4,0) node[draw,circle,scale=1.2,thick] (sum) {$\sum$};
	
	\draw[->] (osc.west) -| (m1);
	\draw[->] (osc.west) -| (ps1) -- (m2);
	\draw[->] (m1) -| (sum);
	\draw[->] (m2) -| (sum.south) node[yshift=-2mm,right] {$\pm$};
	\draw[->] (sum) -- ++(1.5,0) node[right]
	{$s_{\mathrm{USSB}}(t)\Big/s_{\mathrm{LSSB}}(t)$};
	\draw[<-] (m1) -- ++(-5,0) node[above,midway] {$m(t)=A\cos2πf_m(t)$} node[pos=.5] (p) {};
	\draw (p |- 0,-2) node[draw,rectangle] (ps2) {$-90\degree$};
	\draw[->] (p.center) node[circ] {} -- (ps2) -- (m2);
	\draw (ps2.north) node[above,fill=white,draw=white!90!black,scale=1.4,fill opacity=.8,text opacity=1,outer sep=2pt] {Hilbert};
	
	\path (ps1.south) -- (m2.north) node[midway,right,scale=.8] {$\sfrac{1}{2}A_c\sin2πf_ct$};
\end{circuitikz}


\subsubsection{Μετασχηματισμός Hilbert}
\begin{defn}{Μετασχηματισμός Hilbert}{}
	Ο \textbf{μετασχηματισμός Hilbert} είναι ένα \textbf{φίλτρο} με συνάρτηση μεταφοράς:
	\[
	\mathlarger{H(f) = -j \sgn f}
	\]
\end{defn}
Θυμόμαστε τη συνάρτηση \( \sgn \): \begin{tikzpicture}[scale=.5,baseline]
\draw (-2,0) -- (2,0);
\draw (0,-2) -- (0,2);

\draw[red!60!orange!90!blue,ultra thick] (-2,-1) -- (0,-1) (0,1) -- (2,1) node[above] {$\sgn(f)$};
\filldraw[red!50!black,fill=white] (0,-1) circle (3pt) (0,1) circle(3pt);
%\filldraw[] (0,0) circle (2pt);
\end{tikzpicture}

Έχει κρουστική απόκριση:
\[
h(t) = \frac{1}{πt}
\]

Ο μετασχηματισμός βάζει ένα j και αλλάζει το πρόσημο της συνάρτησης.
Πιο συγκεκριμένα, μεταβάλλει το σήμα κατά \( -90\degree \) στις θετικές συχνότητες, και
\( 90\degree \) στις αρνητικές συχνότητες.
Για παράδειγμα:

\begin{tikzpicture}[scale=1]
\draw[draw=blue!50!cyan,very thick]
(-0.8,0)-- (0,1.4)-- (0.8,0);
\draw (0,1.4) node[above right] {$M(0)$};

\draw[->] (-2,0) -- (2,0) node[below] {$f$};
\draw (0,-2.5) -- (0,2.5) node[right] {$M(f)$} node[left] {Re};

\draw[>->,very thick, black]
(2.5,0) -- ++(1.5,0) node[above,midway] {Μ.H.};

\begin{scope}[xshift=7.5cm]
\draw[shading=color wheel,opacity=.2] (1.2,0,0) -- (0,0,-3) -- (0,0,0);
\draw[shading=color wheel,opacity=.2] (-1.2,0,0) -- (0,0,3) -- (0,0,0);
\draw[draw=blue!50!cyan,very thick,fill=red,fill opacity=.1,postaction={pattern=north east lines,opacity=.2}]
(-1.2,0,0) -- (0,0,3) -- (0,0,0);
\draw[draw=blue!50!cyan,very thick,fill=red,fill opacity=.1,postaction={pattern=north east lines,opacity=.2}]
(1.2,0,0) -- (0,0,-3) -- (0,0,0);

\draw (-1.2,0) node[above] {$-w$};
\draw (1.2,0) node[below] {$w$};
\draw (0,0) node[above left] {$0$};

\draw[->] (-3,0) -- (3,0) node[below] {$f$};
\draw[->] (0,-1.5) -- (0,2.5) node[right] {Re};
\draw[->] (0,0,0) -- (0,0,5) node[below right] {Im};
\draw[path fading=east] (0,0,0) -- (0,0,-5);
\end{scope}
\end{tikzpicture}

Ο μετασχηματισμός Hilbert είναι ένας Wide-Band Phase Shifter (WBPS). Και εδώ βρίσκεται το
πρόβλημα. Ο μετασχηματισμός Hilbert είναι ένα ιδανικό φίλτρο που δεν μπορεί να εφαρμοστεί
στην πραγματικότητα:

\begin{tikzpicture}[scale=1]
\draw[ultra thick,blue!70!green] (-3,0,2) -- (0,0,2);
\draw[ultra thick,blue!70!green] (0,0,-2) -- (3,0,-2)  node[pos=.5] (p1) {};
\fill[blue!70!green] (0,0,-2) circle(2pt) (0,0,2) circle(2pt);

\def\act{red!80!yellow}
\begin{scope}
\clip (0,0,2) rectangle (0,0,-2);
\draw[very thick,\act,mark position=0.38(p2)] plot[smooth,tension=1] coordinates
{(-3,0,2) (0,0,1.8) (0,0,-1.8) (3,0,-2)};
\end{scope}
\draw[very thick,\act] (3,0,-1.8) -- (0,0,-1.8);
\draw[very thick,\act] (0,0,1.8) -- (-3,0,1.8);

\draw[blue!70!green,<-] (p1.center) to[bend left] ++(0.5,1) node[right] {ιδανική απόκριση};
\draw[\act!80!black,<-] (p2) to[bend right] ++(0.5,-1) node[right] {πραγματική απόκριση};

\draw (0,0) node[above left] {$0$};

\draw[->] (-3,0) -- (3,0) node[below] {$f$};
\draw[->] (0,-1.5) -- (0,2.5) node[right] {Re};
\draw[->] (0,0,0) -- (0,0,5) node[below right] {Im};
\draw[path fading=east] (0,0,0) -- (0,0,-5);
\end{tikzpicture}

Σε ακουστικά σήματα οι ατέλειες αυτές μπορούν να παραβλεφθο, αλλά σε άλλα σήματα μπορεί να
υπάρχει αισθητή παραμόρφωση.

Επομένως, και οι δύο διαμορφωτές παρουσιάζουν προβλήματα, ο πρώτος στην υλοποίηση του
φίλτρου, και ο δεύτερος στην υλοποίηση του phase shifter.

\subsubsection{Επιστροφή στο πεδίο των συχνοτήτων}
Θα αναλύσουμε το παραπάνω κύκλωμα στη συχνότητα:

\begin{circuitikz}[scale=0.9,every node/.style={scale=.9}]
	\draw (0,-0.75) node[draw,rectangle] (ps1) {$-90\degree$};
	\draw (0,2) node[draw,rectangle,scale=2,outer sep=0] (m1) {$\times$};
	\draw (0,-2) node[draw,rectangle,scale=2, outer sep=0] (m2) {$\times$};
	\draw (2,0) node[oscillator,xshift=4.9mm] (osc) {};
	\draw (4,0) node[draw,circle,scale=1.2,thick] (sum) {$\sum$};
	
	\draw[->] (osc.west) -| (m1);
	\draw[] (osc.west) -| (ps1);
	\draw[->,orange] (ps1) -- (m2);
	\draw[->,orange] (m1) -| node[above right] {(1)} (sum);
	\draw[->,magenta!70!cyan] (m2) -| node[below right] {(2)} (sum.south) node[yshift=-2mm,right] {$\pm$};
	\draw[->,black!80!brown] (sum) -- ++(1.5,0) node[right]
	{$s_{\mathrm{USSB}}(t)\Big/s_{\mathrm{LSSB}}(t)$};
	\draw[<-,draw=blue!70!cyan] (m1) -- ++(-5,0) node[above,midway] {$m(t)=A\cos2πf_m(t)$} node[pos=.5] (p) {};
	\draw[blue!70!green] (p |- 0,-2) node[draw,rectangle] (ps2) {$-90\degree$};
	\draw[blue!70!cyan] (p.center) node[circ] {} -- (ps2);
	\draw[->,orange!50!green] (ps2) -- (m2);
	
	\path (ps1.south) -- (m2.north) node[midway,right,scale=.8] {$\sfrac{1}{2}A_c\sin2πf_ct$};
\end{circuitikz}

Θυμόμαστε το σήμα κατά SSB:
\[
s_{\mathrm{USSB}}(t) = \frac{1}{2}A_c m(t) \cos 2πf_c t - \frac{1}{2}A_c \hat m(t)
\sin 2πf_c t
\]

και βλέπουμε στο πεδίο των συχνοτήτων:
\\*
\begin{tikzpicture}[scale=1]
\draw[ultra thick,blue!70!cyan] (-1,0) -- (0,1.6) -- (1,0);

\draw (-1.2,0) node[below] {$-w$};
\draw (1.2,0) node[below] {$w$};
\draw (0,0) node[above left] {$0$};

\draw[->] (-3,0) -- (3,0) node[below] {$f$};
\draw[->] (0,-1.5) -- (0,2.5) node[right] {Re} node[below left,blue!70!cyan] {$M(f)$};

\begin{scope}[xshift=8cm]
\draw[ultra thick,blue!70!green] (-3,0,2) -- (0,0,2);
\draw[ultra thick,blue!70!green] (0,0,-2) -- (3,0,-2);
\fill[blue!70!green] (0,0,-2) circle(2pt) (0,0,2) circle(2pt);

\draw (0,0) node[above left] {$0$};

\draw[->] (-3,0) -- (3,0) node[below] {$f$};
\draw[->] (0,-1.5) -- (0,2.5) node[right] {Re} node[below left,blue!70!green] {$H(f)$};
\draw[->] (0,0,0) -- (0,0,5) node[below right] {Im};
\draw[path fading=east] (0,0,0) -- (0,0,-5);
\end{scope}

\begin{scope}[yshift=-6cm]
\draw[ultra thick,orange!50!green] (-1,0,0) -- (0,0,2);
\draw[ultra thick,orange!50!green] (0,0,-2) -- (1,0,0);
\fill[orange!50!green] (0,0,-2) circle(2pt) (0,0,2) circle(2pt);

\draw (-1,0) node[above] {$-w$};
\draw (1,0) node[below] {$w$};
\draw (0,0) node[above left] {$0$};

\draw[->] (-3,0) -- (3,0) node[below] {$f$};
\draw[->] (0,-1.5) -- (0,2.5) node[right] {Re} node[below left,orange!50!green] {$H(f)M(f)$};
\draw[->] (0,0,0) -- (0,0,5) node[below right] {Im};
\draw[path fading=east] (0,0,0) -- (0,0,-5);

\begin{scope}[xshift=8cm]
\draw[ultra thick,orange!50!red,->] (1.6,0,0) -- ++(0,0,-3);
\draw[ultra thick,orange!50!red,->] (-1.6,0,0) -- ++(0,0,3);
\fill[orange!50!red] (1.6,0,0) circle(2pt) (-1.6,0,0) circle(2pt);

\draw (-1.6,0) node[above] {$-f_c$};
\draw (1.6,0) node[below] {$f_c$};
\draw (0,0) node[above left] {$0$};

\draw[->] (-3,0) -- (3,0) node[below] {$f$};
\draw[->] (0,-1.5) -- (0,2.5) node[right] {Re} node[below left,orange!50!red]
{$\mathrm{MF}\left[\sin(2πf_ct)\right]$};
\draw[->] (0,0,0) -- (0,0,5) node[below right] {Im};
\draw[path fading=east] (0,0,0) -- (0,0,-5);
\end{scope}
\end{scope}
\end{tikzpicture}

Μετά από τη συνέλιξη του \( H(f)M(f) \) με το μετασχηματισμό του \( \sin(2πf_ct) \),
πολλαπλασιάζονται τα φανταστικά μέρη, \( j\cdot j = -1 \), επομένως
τα σήματα που πηγαίνουν στον αθροιστή επιστρέφουν στο πραγματικό επίπεδο και μοιάζουν
κάπως έτσι:

\begin{tikzpicture}[scale=0.8]
\draw[ultra thick,magenta!70!cyan,xshift=-3cm] (-1,0) -- (0,1.6) -- (0,-1.6) -- (1,0);
\draw[ultra thick,magenta!70!cyan,xshift=+3cm] (-1,0) -- (0,1.6) -- (0,-1.6) -- (1,0) node[midway,below right] {(1)};
\draw[ultra thick,orange,xshift=-3cm,scale=1.09] (-1,0) -- (0,1.6) -- (1,0);
\draw[ultra thick,orange,xshift=3cm,scale=1.09] (-1,0) -- (0,1.6) -- (1,0) node[midway,above right] {(2)};

\draw (-3,0) node[below] {$-f_c$};
\draw ( 3,0) node[below] {$f_c$};

\draw[->] (-6,0) -- (6,0) node[below] {$f$};
\draw[->] (0,-2.5) -- (0,2.5) node[right] {Re} node[below left]
{$\mathrm{MF}\left(m(t)\sin(2πf_ct)\right)$};
\end{tikzpicture}

Και τελικά, καθώς προστίθενται, ουσιαστικά αφαιρείται η κάτω πλευρική ζώνη, και παραμένει
μόνο η επάνω πλευρική ζώνη:

\begin{tikzpicture}[scale=0.8]
\draw[ultra thick,black!80!brown,xshift=-3cm] (-1,0) -- (-0.5,1.6) -- (0,0);
\draw[ultra thick,black!80!brown,xshift=+3cm] (1,0) -- (0.5,1.6) -- (0,0);

\draw (-3,0) node[below] {$-f_c$};
\draw ( 3,0) node[below] {$f_c$};

\draw[->] (-6,0) -- (6,0) node[below] {$f$};
\draw[->] (0,-1.5) -- (0,2.5) node[right] {Re} node[below left]
{$S_{\mathrm{USSB}}(f)$};
\end{tikzpicture}

\subsubsection{Αποδιαμόρφωση}
Το διάγραμμα του αποδιαμορφωτή είναι το εξής:

\begin{circuitikz}[scale=1.6]
	\draw (0,0) node[xshift=4.9mm,oscillator] (osc) {}
	node[above right,xshift=5mm] {$A_c' \cos(2πf_c t + φ)$};
	\draw (0,1) node[rectangle,draw,minimum width=15mm,minimum height=10mm] (mult) {}
	node[scale=1.5] {$\times$};
	\draw (2,1) node[rectangle,draw,minimum width=15mm,minimum height=10mm] (lpf) {}
	node[] {LPF};
	
	\draw[<-] (mult.west) node[above left] {$s(t)$}  -- ++(-2,0) node[above right] {SSB};
	\draw[->] (mult.east) -- (lpf.west) node[above,midway,orange!20!black] {$v(t)$};
	\draw[->] (lpf.east) -- ++(0.5,0) node[right] {$u_o(t)$};
	\draw[->] (osc.north) -- (mult.south);
\end{circuitikz}

Κάνουμε τις πράξεις:
\begin{align*}
	\left. s(t)\cdot A_c' \cos(2πf_ct+φ) \right|_{\mathrm{LPF}}
	&= \frac{A_cA_c'}{4}m(t)\sin φ\cos φ
	\mp \frac{A_cA_c'}{4}\hat m(t) \sin φ
\end{align*}

Αν πετύχουμε ακριβώς τη φέρουσα συχνότητα, δηλαδή αν βρούμε τη φάση του φέροντος και
\( φ = 0 \) (που απαιτεί κύκλωμα συγχρονισμού - άρα έχουμε \textbf{ομόδυνο ή σύγχρονο}
αποδιαμορφωτή, που είναι δυσκολότερος και πιο παλιά ακριβότερος), τότε:
\[
u_o(t) = \frac{A_cA_c'}{4}m(t)
\]

Σε διαφορετική περίπτωση όμως, προστίθεται ο όρος \( \frac{A_cA_c'}{4}\hat m(t) \sin φ \),
ο οποίος είναι μια παραμόρφωση που είναι ουσιαστικά το σήμα μετασχηματισμένο κατά
Hilbert. Αυτός ο όρος εισάγει μια διαφορά φάσης, η οποία παραμορφώνει ιδιαίτερα τη
φωνή, προκαλώντας το \textbf{φαινόμενο Donald Duck}.
Αυτό απέτρεψε τη χρησιμοποίηση αυτού του είδους διαμόρφωσης στην κλασική ραδιοφωνία, παρά
μόνον συνήθως για εσωτερική χρήση στη βιομηχανία, όταν απαιτείται εξοικονόμηση φάσματος.

\subsection{VSB}
Η παραπάνω ανάλυση έχει νόημα όταν μιλάμε για ακουστικά σήματα, τα οποία δεν ξεκινάνε από
τα 0 Hz, αλλά π.χ από τα 300 Hz, επιτρέποντας την ευκολότερη υλοποίηση του φίλτρου ή του
μεταφορέα φάσης. Σε υπόλοιπα (π.χ. τηλεοπτικά) σήματα όμως δεν ισχύει αυτό:

\begin{center}
\begin{tikzpicture}
\draw (-2,0) -- (2,0);
\draw (0,-1) -- (0,2);

\draw[dashed] plot[smooth,tension=1]
coordinates {(-1.8,0) (0,1.7) (1.8,0)};

\draw[xshift=1cm,blue!50!cyan,ultra thick] plot [smooth]
coordinates {(-0.5,0) (-0.4,0.1) (0,0.6) (0.4,0.1) (0.5,0)};
\draw[xshift=-1cm,blue!50!cyan,ultra thick] plot [smooth]
coordinates {(-0.5,0) (-0.4,0.1) (0,0.6) (0.4,0.1) (0.5,0)};

\draw[green!50!yellow!50!black,<->,yshift=2mm] (-1+0.5,0) -- (+1-0.5,0) node[above,midway,scale=.7] {600 Hz};

\draw (0,-1) node[below] {ακουστικό σήμα};

\begin{scope}[xshift=5cm]
\draw (-2,0) -- (2,0);
\draw (0,-1) -- (0,2);

\draw[red!50!yellow,ultra thick,scale=.8] plot[smooth,tension=1]
coordinates {(-1.8,0) (0,1.7) (1.8,0)};

\draw (0,-1) node[below] {τηλεοπτικό σήμα};
\end{scope}
\end{tikzpicture}
\end{center}

Για αυτό το λόγο, σκεφτόμαστε ένα άλλο είδος διαμόρφωσης, στο οποίο δεν κόβουμε ολόκληρη την
π.χ. κάτω πλευρική ζώνη της πληροφορίας, αλλά επιτρέπουμε να περάσει και ένα κομμάτι από
αυτήν:
\todo{Improvise a graph}

Αυτή η διαμόρφωση ονομάζεται \textbf{VSB (Vestigial Side Band)} και έχει απόκριση της μορφής:

\begin{tikzpicture}
\draw (-6,0) -- (6,0);
\draw (0,-1) -- (0,3);

\def\fa{2+0.15}
\def\fb{5.8}
\def\tz{1}
\def\A{2}
\filldraw[fill=blue!80!cyan!80!black,fill opacity=.15,path fading=east,thick]
plot[smooth,tension=1] coordinates {
	(\fa-\tz,0) (\fa-\tz+\tz/4,\A/8) (\fa-\tz/2,\A/2) (\fa-\tz/4,7*\A/8) (\fa,\A)
}
--
plot[smooth,tension=1] coordinates {
	(\fb,\A) (\fb+\tz/4,7*\A/8) (\fb+\tz/2,\A/2) (\fb+3*\tz/4,\A/8) (\fb+\tz,0)
}
;

\draw[xshift=2cm,blue!70!black] (-1.5,0) -- (0,2) -- (1.5,0);


\draw[dashed] (2,0) node[below] {$f_c$} -- ++(0,2);
\draw[dashed,path fading=north] (\fa-\tz,0) -- ++(0,2);
\draw (\fa-\tz,0) node[below,scale=.8] {$f_c-f_v$};
\draw (2+1.5,0) node[below,scale=.8] {$f_c+w$};

\begin{scope}[xscale=-1]
\filldraw[fill=blue!80!cyan!80!black,fill opacity=.15,path fading=west]
plot[smooth,tension=1] coordinates {
	(\fa-\tz,0) (\fa-\tz+\tz/4,\A/8) (\fa-\tz/2,\A/2) (\fa-\tz/4,7*\A/8) (\fa,\A)
}
--
plot[smooth,tension=1] coordinates {
	(\fb,\A) (\fb+\tz/4,7*\A/8) (\fb+\tz/2,\A/2) (\fb+3*\tz/4,\A/8) (\fb+\tz,0)
}
;


\draw[dashed] (2,0) node[below] {$-f_c$} -- ++(0,1) edge[path fading=north] ++(0,1);
\end{scope}
\end{tikzpicture}

Βέβαια παρατηρούμε ένα πρόβλημα, το οποίο θα προσπαθήσουμε να διορθώσουμε αργότερα.
Συγκεκριμένα ότι το σήμα εξόδου μετά το φίλτρο δεν θα
περιέχει μόνο την πάνω πλευρική ζώνη, αλλά και ένα μέρος της κάτω, οδηγώντας σε κάποια
παραμόρφωση:
\todo{Improvise a graph}

Ο διαμορφωτής μοιάζει κάπως έτσι:

\begin{circuitikz}[scale=1.6]
	\draw (0,-0.5) node[xshift=4.9mm,oscillator] (osc) {}
	node[above right,xshift=5mm] {$A_c' \cos(2πf_c t + φ)$};
	\draw (0,1) node[rectangle,draw,minimum width=15mm,minimum height=10mm] (mult) {}
	node[scale=1.5] {$\times$};
	\draw (2.5,1) node[rectangle,draw,minimum width=15mm,minimum height=10mm] (bpf) {}
	node[] {$H(f)$};
	
	\draw[<-] (mult.west)  -- ++(-1,0) node[midway,below] {$m(t)$};
	\draw[->] (mult.east) -- (bpf.west) node[above,midway,orange!20!black] {$u(t)$} node[below,midway] {DSB-SC};
	\draw[->] (bpf.east) -- ++(1,0) node[above,midway] {$s(t)$} node[below,midway] {VSB};
	\draw[->] (osc.north) -- (mult.south);
	
	\draw (bpf.north) node[above,scale=.9] {BPF};
\end{circuitikz}

και πολύ απλά εφαρμόζει το παραπάνω φίλτρο στην εκπεμπόμενη συχνότητα:
\begin{align*}
	S(f) &= U(f)H(f) = \frac{A_c}{2}\left[ M(f-f_c)+M(f+f_c) \right]
\end{align*}

Ο αποδιαμορφωτής είναι ομόδυνος:

\begin{circuitikz}[scale=1.6]
	\draw (0,0) node[xshift=4.9mm,oscillator] (osc) {}
	node[above right,xshift=5mm] {$A_c' \cos2πf_c t$};
	\draw (0,1) node[rectangle,draw,minimum width=15mm,minimum height=10mm] (mult) {}
	node[scale=1.5] {$\times$};
	\draw (1.6,1) node[rectangle,draw,minimum width=15mm,minimum height=10mm] (lpf) {}
	node[] {LPF};
	
	\draw[<-] (mult.west) -- ++(-0.5,0) node[left] {$s(t)$};
	\draw[->] (mult.east) -- (lpf.west) node[above,midway,orange!20!black] {$v(t)$};
	\draw[->] (lpf.east) -- ++(0.5,0) node[right] {$u_o(t)$};
	\draw[->] (osc.north) -- (mult.south);
\end{circuitikz}

Για αυτόν ισχύει:
\begin{align*}
	v(t) &= A_c' \cos 2πf_c t s(t) \\
	V(f) &= \frac{A_c'}{2} \left[ S(f-f_c)+S(f+f_c) \right]
	\\ &= \frac{A_c'A_c}{4}\left[ M(f-2f_c)+M(f) \right]H(f-f_c)
	+\frac{A_c'A_c}{4}\left[ M(f)+M(f+2f_c) \right]H(f+f_c)
	\\ &= \frac{A_c'A_c}{4}M(f)\left[H(f-f_c)+H(f+f_c)\right]
	+ \frac{A_c'A_c}{4}\left[M(f-2f_c)H(f-f_c)+M(f+2f_c)H(f+f_c)\right]
\end{align*}
Ας δούμε έναν-έναν τους όρους:
\todo{Graph 64}

Παρατηρούμε ότι στο κέντρο υπάρχει η επίδραση και των δύο φίλτρων επάνω στο σήμα. Για
να πάρουμε το αρχικό, θα πρέπει η πρόσθεσή τους να μην επηρεάζει την έξοδο, δηλαδή:
\[
H(f-f_c)+H(f+f_c) = 1
\]

Σε διαφορετική περίπτωση, η έξοδος θα είναι παραμορφωμένη:
\todo{Graph 65}

Ενώ, αν έχουμε σωστά ρυθμισμένα φίλτρα σύμφωνα με παραπάνω, θα προστίθενται τα δύο σήματα
για να πάρουμε το τέλειο αρχικό:
\todo{Graph 66}

Δηλαδή, το χαρακτηριστικό που απαιτούμε είναι η απλώς η περιττή συμμετρία (γύρω από το
\( f_c \)) του φίλτρου, και τέτοια φίλτρα μπορούν να κατασκευαστούν:
\todo{Graph 67}

Ως \underline{άσκηση για το σπίτι} αφήνεται η γεωμετρική απόδειξη του ότι η απλή συμμετρία
του φίλτρου σημαίνει ότι και το ύψος του αθροίσματος θα παραμένει σταθερό.

Με βάση αυτήν τη διαμόρφωση λειτουργεί η αναλογική τηλεόραση.

\subsubsection{Λίγα λόγια για την τηλεόραση}
Το εύρος ζώνης ενός τηλεοπτικού καναλιού είναι τυπικά \textit{6 MHz}, και εκπέμπεται σε
κάποια συχνότητα μεταξύ 54-216 MHz (VHF, με ένα κενό για τα FM) ή 470-890 MHz (UHF).

Ας ασχοληθούμε με ένα κανάλι μεταξύ 54-60 MHz. Αρχικά, στέλνουμε έναν κλασικό AM τόνο
στα 55.25 MHz, ο οποίος θα βοηθήσει στην αποδιαμόρφωση (ώστε να γίνει φθηνότερη):
\todo{Graph 68}

Στη συνέχεια, απλώνουμε το φάσμα μεταξύ 54 ως 59.75 MHz (αφήνοντας 0.25 MHz στα δεξιά
για τον ήχο διαμορφωμένο κατά FM). Τα 1.25 MHz στα αριστερά του δέλτα είναι η κάτω πλευρική
ζώνη, και τα 4.5 στα δεξιά είναι η άνω πλευρική ζώνη.
\todo{Graph 69}

Η μορφή του σήματος που στέλνουμε οφείλεται στον τρόπο που λειτουργούσαν οι τηλεοράσεις
CRT: Ένα κανόνι ηλεκτρονίων σκανάρει την οθόνη κατά γραμμές και στήλες - σκανάρει πρώτα
τα κελιά μιας γραμμής, μετά της επόμενης, κ.ό.κ. Επομένως, το σήμα αποτελείται από τις
φωτεινότητες των κελιών της πρώτης γραμμής, μετά ένα κενό (που γίνεται παλμός στο σήμα)
μέχρι το κανόνι να μεταφερθεί στην επόμενη γραμμή, στη συνέχεια τις φωτεινότητες
της επόμενης γραμμής κ.ό.κ.

Με τους παραπάνω παλμούς μπορεί τα επιτευχθεί και συγχρονισμός, ενώ κάποιες τεχνικές
πολυπλεξίας χρησιμοποιήθηκαν και για τη μεταφορά πληροφοριών χρώματος.

Από τη μεριά του δέκτη, η αποδιαμόρφωση μπορεί να γίνει χωρίς να δίνουμε πολλή σημασία
στην κάτω πλευρική ζώνη:
\todo{Graph 71}

Αντίστοιχα, ένα ψηφιακό τηλεοπτικό σήμα (π.χ. με ρυθμό 20 Mbit/s) μπορεί να χωρέσει
αντίστοιχα στα 6 MHz:
\todo{Graph 72}

\subsection{Εφαρμογές}
\paragraph{1.}
Μερικές διαμορφώσεις:
\begin{alignat*}{2}
	\text{AM} \quad && s(t) &= \left(1+k_am(t)\right)\cos 2πf_c t \\
	\text{DSB-SC} \quad && s(t) &= A_c m(t)\cos 2πf_c t\\
	\text{SSB} \quad && s(t) &= \frac{1}{2} A_cm(t)\cos 2πf_c t \mp \frac{1}{2}A_c\hat m(t)\sin2π
	f_c t
	\\ && &= \frac{1}{2}A_c\sqrt{m^2(t)+\hat m^2(t)}\cos\left(2πf_c t +\phi(t)\right)
\end{alignat*}
όπου \( \displaystyle φ(τ) = \tan^{-1}\frac{\hat m(t)}{m(t)} \).

Οι πρώτες δύο διαμορφώσεις έχουν την πληροφορία μόνο στο πλάτος, αλλά η τελευταία την
περιλαμβάνει και στην φάση \( \phi(t) \).

Αν φανταστούμε όμως ότι η πληροφορία αποτελείται από δύο ψηφιακά σήματα, στα οποία το πλάτος
1 αναπαριστά το 1 και το -1 αναπαριστά το ψευδές, τότε το μέτρο θα είναι πάντα \( \sqrt{2} \),
αλλά μόνο η φάση θα μεταβάλλεται. Αυτή η διαμόρφωση χρησιμεύει για τη μετάδοση ψηφιακών δεδομένων
και ονομάζεται QPSK (Quadrature Phase-Shift Keying).

\paragraph{2.}
Έστω τα σήματα πληροφορίας και φέροντος:
\begin{align*}
	m(t) &= A_m\cos(2πf_m t) \\
	c(t) &= A_c\cos(2πf_c t)
\end{align*}

Έστω ότι θέλουμε να το διαμορφώσουμε κατά SSB. Πρώτα το διαμορφώνουμε κατά DSB, και μετά
εφαρμόζουμε ένα φίλτρο:
\todo{Graph 73}

Το φίλτρο αυτό κόβει την κάτω πλευρική ζώνη και αφήνει να περάσει ένα ίχνος της, και κόβει
και την πάνω πλευρική ζώνη, αφήνοντας να περάσει ένα ακόμα μικρότερο ίχνος της.

Δηλαδή κόβει ένα ποσοστό \( k \) (π.χ 2\%) από την επάνω (άρα αφήνει να περάσει το \( (1-k)
 \) ή π.χ. το 98\%), και αφήνει να περάσει ένα ποσοστό \( k \) από την κάτω (αν θεωρήσουμε
 ότι το φίλτρο είναι συμμετρικό).
 
Το αποδιαμορφωμένο σήμα θα μοιάζει κάπως έτσι:
\todo{Graph 74}

Το διαμορφωμένο σήμα, όπως παρατηρούμε από το πεδίο των συχνοτήτων, θα έχει τη μορφή:
\begin{align*}
	s_{\mathrm{USB}}(t) &= \frac{1}{2}kA_cA_m\cos 2π(f_c+f_m)t
	+ \frac{1}{2}(1-k)A_cA_m\cos 2π (f_c-f_m)t \\
	&= \frac{1}{2}kA_cA_m\left(
	\cos2πf_ct\cos2πf_mt-\sin2πf_ct\sin2πf_mt
	\right) + \frac{1}{2}(1-k)A_cA_m\left(
	\cos2πf_ct\cos2πf_mt+\sin2πf_ct\sin2πf_mt
	\right)
	\\ &=
	\underbrace{\frac{1}{2}A_cA_m\cos2πf_m t\cos2πf_c t}_{\text{DSB-SC}}
	+ \underbrace{\frac{1}{2}A_cA_m(1-2k)\sin2πf_mt\sin2πf_ct}_{\text{DSB-SC στον
			μετασχηματισμό Hilbert}}
\end{align*}

Δηλαδή μπορούμε να φτάσουμε στην έξοδο διαμορφώνοντας δύο φορές κατά DSB-SC (τη
δεύτερη την εφαρμόζουμε στο phase-shifted κατά \( 90\degree \) σήμα).

Η σταθερά \( k \) εξαρτάται από την κλίση του φίλτρου που χρησιμοποιήσαμε παραπάνω.
Πιο συγκεκριμένα, έχουμε διαφορετικές περιπτώσεις:

\begin{enumpar}
	\item Για \( k=\frac{1}{2} \), έχουμε \emph{DSB-SC}
	\item Για \( k=0 \), έχουμε \emph{LSSB} \\
	Για \( k=1 \), έχουμε \emph{USSB}
	\item Για \( 0\leq k \leq \frac{1}{2} \), έχουμε \emph{VSB} (πάνω πλευρική ζώνη)
	\\
	Για \( \frac{1}{2} \leq k \leq 1 \), έχουμε \emph{VSB} (κάτω πλευρική ζώνη)
\end{enumpar}

Δηλαδή μπορούμε να πάρουμε όλες τις διαμορφώσεις που παρουσιάσαμε με κατάλληλη επιλογή
του \( k \), εκτός από το ΑΜ.

\subparagraph{}
Για την \textbf{αποδιαμόρφωση}, θα χρειαστεί σίγουρα να έχουμε \textit{σύμφωνο / σύγχρονο / ομόδυνο / coherent}
αποδιαμορφωτή (που μπορεί να βρει τη φάση του φέροντος), ο οποίος πρέπει να γνωρίζει
τη φάση του φέροντος η οποία:
\begin{itemize}
	\item Προκύπτει στον ταλαντωτή και δεν είναι γνωστή στο δέκτη
	\item Μπορεί να μεταβάλλεται αργά στον ταλαντωτή και δεν έχει σταθερή τιμή
	\item Αλλάζει ανάλογα με το μέσο διάδοσης του κύματος και τυχόν εμπόδια
\end{itemize}

Τυπικά για την υλοποίηση του αποδιαμορφωτή, αν θεωρήσουμε ότι κάπως έχουμε βρει τη
φάση του φέροντος, πολλαπλασιάζουμε το λαμβανόμενο σήμα
με τη συχνότητα του φέροντος:
\begin{align*}
	v(t) &= s_{\mathrm{USB}}(t) A_c' \cos 2πf_c t
	\\ &= \left[\frac{1}{2}A_cA_c' A_m\cos2πf_mt\right]
	\cancelto{\frac{1}{2}+\frac{1}{2}\cos2π2f_ct}{\cos^22πf_ct}
	\\ &\hphantom{=}
	+ \left[\frac{1}{2}A_cA_c'A_m(1-2k)\sin2πf_mt\right]
	\cancelto{\frac{1}{2}\sin2π2f_ct }{\sin2πf_ct\cos2πf_ct}
	\\
	\left.v(t)\right|_{\mathrm{LPF}} &= \frac{1}{4} A_cA_c' A_m\cos2πf_m t \quad
	\to m(t)
\end{align*}

Έστω όμως ότι στέλνω ένα σήμα \( s_{\mathrm{VSB}+C}(t) = A_c\cos2πf_ct +
k_as_{\mathrm{VSB}}(t) \), δηλαδή VSB μαζί όμως με το φέρον.
Τότε το σήμα που στέλνω είναι:
\begin{align*}
	s_{\mathrm{USB}+C} (t) &=
	A_c\cos2πf_c t + k_a s_{\mathrm{USB}}(t)
	\\ &= \dots =
	A_c\left[ 1+\frac{k_a}{2}A_m\cos(2πf_mt) \right]\cos2πf_c t
	+ \left[\frac{k_a}{2} A_c A_m (1-2k) \sin(2πf_mt) \right]\sin2πf_ct
	\\ &= A(t) \cdot \cos\left(2πf_ct + φ(τ)\right)
\end{align*}
όπου:
\begin{align*}
	A(t) &=
	\sqrt{A_c^2\left[ 1+\frac{k_a}{2}A_m \cos(2πf_mt) \right]^2
		+A_c^2\left[ \frac{k_a}{2}A_m(1-2k)\sin(2πf_mt) \right]^2
	} \\ &= A_c\left[ 1+\frac{k_a}{2}A_m\cos(2πf_mt) \right]
	\sqrt{1+\left(\frac{\frac{k_a}{2}A_m(1-2k)\sin2πf_ct}{
			1+\frac{k_a}{2}A_m\cos2πf_mt}\right)^2}
\end{align*}

Δηλαδή έχουμε μία διαμόρφωση AM \( 1+\frac{k_a}{2}A_m\cos(2πf_m t) \) μαζί με μία
παραμόρφωση \( \sqrt{1+(\cdots)^2} \), την οποία θέλουμε να ελαχιστοποιήσουμε όσο
περισσότερο γίνεται. Αυτό δικαιολογεί και το ότι για την αποδιαμόρφωση του τηλεοπτικού
σήματος αρκεί μόνο ένας αποδιαμορφωτής FM.

Στόχος μας είναι να ελαχιστοποιήσουμε την παραμόρφωση, άρα τον όρο:
\[
\left[\frac{μ(1-2k)\sin2πf_ct}{1+μA_m\cos2πf_mt}\right]^2
\]
(όπου \( μ = \frac{1}{2}k_aA_m \) ), τον οποίο μπορούμε να ρυθμίσουμε επιλέγοντας τις
σταθερές της διαμόρφωσης \( A_m \), το συντελεστή του φέροντος \( k_a \), ή την κλίση \( k \)
του φίλτρου.

\paragraph{3.}
Θυμόμαστε τη βασική λειτουργία του πολλαπλασιαστικού διαμορφωτή:
\todo{Graph 75}

με έξοδο:
\begin{align*}
	s'(t) &= s_1(t)A_c\cos(2πf_l t) \\
	&= \frac{1}{2}A_l m(t) \left[
	\cos2π(f_1+f_l)t + \cos 2π(f1-f_l)t
	\right]
\end{align*}
όπου μπορούμε να επιλέξουμε ποιός μόνον από τους δύο όρους (\( f_1+f_l \) ή \( f_1-f_l \), και
ονομάζουμε τη διαδικασία up conversion ή down conversion αντίστοιχα) θα βγει στην έξοδο
από το Band Pass φίλτρο. Με κατάλληλη επιλογή της \( f_l \) και του φίλτρου, μπορούμε να
ελέγξουμε ποιά συχνότητα εξόδου θέλουμε να πολλαπλασιάσουμε με το σήμα, ώστε να έχουμε
όποια μετατόπιση θέλουμε στην έξοδο:
\todo{Graph 76}

\paragraph{4. Πολυπλεξία (multiplexing)}
Είναι γνωστό πως στον αέρα σήμερα υπάρχει μεγάλος αριθμός διαμορφωμένων τηλεοπτικών,
ραδιοφωνικών, κλπ. σημάτων. Ας εξετάσουμε πώς είναι δυνατό να στέλνονται όλα αυτά ταυτόχρονα.

\subparagraph{FDMA}

Προφανώς αν στείλουμε δύο διαμορφωμένα σήματα στην ίδια συχνότητα ταυτόχρονα χωρίς παραπάνω
επεξεργασία, ο δέκτης θα αποδιαμορφώσει το άθροισμα τους, και δεν μπορούμε να
πάρουμε το καθένα ξεχωριστά.
\todo{Graph 77}

Αν όμως δώσουμε στο κάθε σήμα τη δική του συχνότητα, τότε ο κάθε δέκτης μπορεί να
συντονιστεί στο επιθυμητό σημείο και να δώσει κάθε σήμα ξεχωριστά, όπως επιθυμούμε:
\todo{Graph 78}

Αυτή η τεχνική ονομάζεται \textbf{Frequency-Division Multiple Access (FDMA)}, δηλαδή
πολυπλεξία στη συχνότητα.

Για παράδειγμα, ένας τηλεπικοινωνιακός οργανισμός που θέλει να στείλει πολλά σήματα 
φωνής μέσω ενός καναλιού (π.χ. καλωδίου), μπορεί να διαμορφώνει κάθε σήμα και να του
αναθέτει το δικό του πεδίο συχνοτήτων.

Για παράδειγμα, αν έχουμε \( N \) φωνητικά σήματα (θεωρούμε ότι έχουν εύρος ζώνης
μεταξύ 300-3300 Hz, δηλαδή περίπου 4 kHz), τότε πρέπει να διαμορφώσουμε το καθένα
ξεχωριστά, με πολλαπλάσια μιας βασικής συχνότητας φέροντος (π.χ. 4 kHz):
\todo{Graph 79}

Έτσι, στο φάσμα των συχνοτήτων έχουμε πολλά σήματα κολλημένα μεταξύ τους:
\todo{Graph 80}

Και ο αποδιαμορφωτής ακολουθεί ακριβώς την αντίστροφη διαδικασία:
\todo{Graph 81}

Για τον επιπλέον έλεγχο του φάσματος, τα σήματα μπορεί να ενώνονται σε ομάδες, οι οποίες
ενώνονται σε υπερομάδες, και στη συνέχεια σε super-groups, ενώ για δημόσια κανάλια
(π.χ. για ραδιοφωνικούς σταθμούς) μπορεί να υπάρχει κάποιος οργανισμός που να ελέγχει την
κατανομή των συχνοτήτων.

\subparagraph{TDMA}
Η ιδέα του \textbf{Time-Division Multiple Access (TDMA)} βασίζεται στο ότι για να πάρουμε
τις τιμές ενός σήματος το δειγματοληπτούμε ανά τακτά χρονικά διαστήματα:
\todo{Graph  83}

Σκεφτόμαστε αν π.χ. έχουμε 3 σήματα, κάθε φορά που δειγματοληπτείται το πρώτο, μετά από
λίγο να δειγματοληπτείται το δεύτερο, μετά το τρίτο, και μετά να ξεκινάμε ξανά από την
αρχή, δειγματοληπτώντας το πρώτο, το δεύτερο, κ.ό.κ:
\todo{Graph 84}

Έτσι, μέσα σε κάθε frame (χρονοθυρίδα),
μπορούμε να δειγματοληπτήσουμε πολλά (π.χ. 100) διαφορετικά σήματα.

Η τεχνική αυτή μπορεί να χρησιμοποιηθεί και για ψηφιακά σήματα, ενώ είναι δυνατόν να
συνδυαστεί με το FDMA για πολυπλεξία ακόμα περισσότερων σημάτων.

\subparagraph{CDMA}
Το \textbf{Code-Division Multiple Access (CDMA)} εφαρμόζεται σε ψηφιακά σήματα, που θεωρούμε
ότι μπορούν να λάβουν π.χ. μόνο τις τιμές 1 ή -1.

Έστω δύο σήματα:
\todo{Graph 84}

Με κατάλληλο πολλαπλασιασμό, άθροιση και ολοκλήρωση, θα λάβουμε ένα σήμα ευρείας μπάντας
που περιέχει τα δεδομένα μας, ενώ θα είναι αντιληπτό μόνο ως θόρυβος σε κάποιον άλλον ακροατή,
κάτι που έκανε αυτήν την κωδικοποίηση χρήσιμη στον Β' Παγκόσμιο Πόλεμο.

\todo{συμπλήρωση?}

\subsection{Ένα μαθηματικό ερώτημα που τέθηκε παραπάνω}
\begin{infobox}{}
	Έστω \( H(f) \) είναι η χαρακτηριστική μεταφοράς πλάτους ενός ζωνοπερατού φίλτρου,
	η οποία περιγράφεται \textbf{στις θετικές συχνότητες} από τη σχέση:
	\[
	H(f) = \begin{cases}
	c, \qquad & f \in \left[ f_c+f_v,\ f_c+w \right]\text{ (ζώνη διέλευσης)} \\
	G(f),\qquad & f\in \left[f_c-f_v,\ f_c+f_v\right]\text{ (ζώνη μετάδοσης)} \\
	0,\qquad & \text{αλλού}
	\end{cases}
	\]
	
	Η απαίτηση \( H(f+f_c) + H(f-f_c) = c \) στο διάστημα \( [-f_v,+f_v] \) απαιτεί από
	το τμήμα \( G(f) \) της χαρακτηριστικής να παρουσιάζει περιττή συμμετρία γύρω από το
	σημείο \( \left(f_c,\ H(f_c)\right) \).
	
	Να αποδειχθεί μαθηματικά και πλήρως η παραπάνω πρόταση.
\end{infobox}

\end{document}
